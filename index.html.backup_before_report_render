<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ThinkCraft - AI思维助手</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --bg-sidebar: #f3f4f6;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --text-tertiary: #9ca3af;
            --border: #e5e7eb;
            --shadow: rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
            position: relative;
        }

        .sidebar {
            width: 280px;
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 16px;
        }

        .new-chat-btn {
            width: 100%;
            padding: 12px 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: background 0.2s;
        }

        .new-chat-btn:hover {
            background: var(--primary-dark);
        }

        .new-chat-btn:active {
            transform: scale(0.98);
        }

        .chat-history {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }

        .chat-item {
            padding: 12px;
            margin-bottom: 4px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 14px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-item:hover {
            background: rgba(99, 102, 241, 0.1);
        }

        .chat-item.active {
            background: rgba(99, 102, 241, 0.15);
            color: var(--primary);
            font-weight: 500;
        }

        .chat-item-icon {
            width: 20px;
            height: 20px;
            opacity: 0.6;
        }

        .chat-item-content {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .chat-item-actions {
            display: none;
            position: relative;
        }

        .chat-item:hover .chat-item-actions {
            display: block;
        }

        .chat-item-more {
            width: 24px;
            height: 24px;
            border: none;
            background: none;
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-tertiary);
            transition: background 0.2s;
        }

        .chat-item-more:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .chat-item-menu {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 10;
            min-width: 120px;
            margin-top: 4px;
        }

        .chat-item-menu.active {
            display: block;
        }

        .chat-item-menu-item {
            padding: 10px 16px;
            cursor: pointer;
            font-size: 13px;
            color: var(--text-secondary);
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chat-item-menu-item:hover {
            background: var(--bg-secondary);
        }

        .chat-item-menu-item:first-child {
            border-radius: 8px 8px 0 0;
        }

        .chat-item-menu-item:last-child {
            border-radius: 0 0 8px 8px;
        }

        .chat-item-menu-item.danger {
            color: #ef4444;
        }

        .chat-item.pinned {
            background: rgba(99, 102, 241, 0.08);
            border-left: 3px solid var(--primary);
            padding-left: 9px;
        }

        .chat-item.pinned .chat-item-content {
            font-weight: 600;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
            position: relative;
        }

        .main-header {
            padding: 16px 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
        }

        .main-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        .icon-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: none;
            cursor: pointer;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
            color: var(--text-secondary);
        }

        .icon-btn:hover {
            background: var(--bg-secondary);
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            scroll-behavior: smooth;
        }

        .empty-state {
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--text-tertiary);
        }

        .empty-icon {
            width: 64px;
            height: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .empty-subtitle {
            font-size: 14px;
            margin-bottom: 24px;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            max-width: 600px;
            width: 100%;
        }

        .quick-action {
            padding: 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }

        .quick-action:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .quick-action-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .quick-action-desc {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .message {
            margin-bottom: 24px;
            display: flex;
            gap: 12px;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .message.user .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .message.assistant .message-avatar {
            background: var(--bg-secondary);
            color: var(--primary);
        }

        .message-content {
            flex: 1;
            max-width: 680px;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .message-role {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .message-time {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .message-text {
            font-size: 15px;
            line-height: 1.6;
            color: var(--text-primary);
            white-space: pre-line;
        }

        .message.assistant .message-text {
            color: var(--text-secondary);
        }

        .message-actions {
            margin-top: 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .action-chip {
            padding: 8px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .action-chip:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .report-buttons {
            margin-top: 16px;
            display: flex;
            gap: 12px;
        }

        .view-report-btn {
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }

        .view-report-btn:hover {
            background: var(--primary-dark);
        }

        .share-btn {
            padding: 12px 24px;
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .share-btn:hover {
            background: var(--primary);
            color: white;
        }

        .input-container {
            padding: 20px 24px;
            border-top: 1px solid var(--border);
            background: var(--bg-primary);
        }

        .input-wrapper {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        .input-tools {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .tool-btn {
            padding: 8px 14px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .tool-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .input-box {
            display: flex;
            gap: 12px;
            align-items: flex-end;
            padding: 12px 16px;
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            transition: border-color 0.2s;
        }

        .input-box:focus-within {
            border-color: var(--primary);
        }

        .main-input {
            flex: 1;
            border: none;
            background: none;
            outline: none;
            font-size: 15px;
            resize: none;
            max-height: 120px;
            line-height: 1.5;
            font-family: inherit;
        }

        .send-btn {
            width: 36px;
            height: 36px;
            background: var(--primary);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .send-btn:hover {
            background: var(--primary-dark);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .send-btn svg {
            width: 20px;
            height: 20px;
            color: white;
        }

        /* 模态框通用样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.2s ease;
        }

        .modal.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            width: 95%;
            max-width: 1000px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            animation: slideUpModal 0.3s ease;
        }

        @keyframes slideUpModal {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .close-btn {
            width: 32px;
            height: 32px;
            background: none;
            border: none;
            cursor: pointer;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
        }

        .close-btn:hover {
            background: var(--bg-secondary);
        }

        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        /* 详细报告样式 */
        .report-section {
            margin-bottom: 32px;
        }

        .report-section-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-primary);
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
        }

        .analysis-card {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .analysis-card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .analysis-icon {
            width: 32px;
            height: 32px;
            background: var(--primary);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .analysis-card-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .analysis-card-content {
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .insight-item {
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 12px;
            margin-bottom: 12px;
            display: flex;
            gap: 12px;
        }

        .insight-number {
            width: 28px;
            height: 28px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .insight-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .score-bar {
            margin: 12px 0;
        }

        .score-label {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            margin-bottom: 8px;
        }

        .score-track {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, #6366f1, #a855f7);
            border-radius: 4px;
            transition: width 0.6s ease;
        }

        /* 分享卡片样式 - 优雅简约风格 */
        .share-card-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
        }

        .share-card {
            width: 100%;
            max-width: 500px;
            aspect-ratio: 1;
            background: linear-gradient(135deg, #fdfbfb 0%, #f7f5ff 100%);
            border-radius: 24px;
            padding: 44px;
            position: relative;
            overflow: hidden;
            box-shadow:
                0 0 0 1px rgba(99, 102, 241, 0.1),
                0 8px 24px rgba(99, 102, 241, 0.12),
                0 16px 48px rgba(99, 102, 241, 0.08);
        }

        /* 装饰性色块 */
        .share-card::before {
            content: '';
            position: absolute;
            top: -80px;
            right: -80px;
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            border-radius: 50%;
            opacity: 0.08;
            pointer-events: none;
        }

        .share-card::after {
            content: '';
            position: absolute;
            bottom: -60px;
            left: -60px;
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, #ec4899 0%, #f43f5e 100%);
            border-radius: 50%;
            opacity: 0.06;
            pointer-events: none;
        }

        .share-card-header {
            position: relative;
            z-index: 1;
            margin-bottom: 36px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .share-card-logo {
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
        }

        .share-card-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: white;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #6366f1;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1);
        }

        .share-card-badge::before {
            content: '✨';
            font-size: 14px;
        }

        .share-card-main {
            position: relative;
            z-index: 1;
            margin-bottom: 32px;
        }

        .share-card-label {
            font-size: 13px;
            color: #9ca3af;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .share-card-idea {
            font-size: 32px;
            font-weight: 700;
            line-height: 1.3;
            color: #1f2937;
            margin-bottom: 20px;
            letter-spacing: -0.5px;
        }

        .share-card-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .share-tag {
            padding: 6px 14px;
            background: white;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            color: #6b7280;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
        }

        .share-card-stats {
            position: relative;
            z-index: 1;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }

        .share-stat {
            text-align: center;
            padding: 20px 16px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .share-stat:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(99, 102, 241, 0.15);
        }

        .share-stat-value {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 6px;
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }

        .share-stat-label {
            font-size: 12px;
            color: #9ca3af;
            font-weight: 500;
        }

        .share-card-footer {
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: 24px;
            border-top: 1px solid rgba(0, 0, 0, 0.06);
        }

        .share-card-footer-text {
            flex: 1;
        }

        .share-card-footer-label {
            font-size: 11px;
            color: #9ca3af;
            margin-bottom: 4px;
            font-weight: 500;
        }

        .share-cta {
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
        }

        .share-qr {
            width: 52px;
            height: 52px;
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .share-qr::before {
            content: '◼';
        }

        .share-actions {
            display: flex;
            gap: 12px;
            width: 100%;
            max-width: 500px;
        }

        .share-action-btn {
            flex: 1;
            padding: 14px 24px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .share-action-btn.primary {
            background: var(--primary);
            color: white;
        }

        .share-action-btn.primary:hover {
            background: var(--primary-dark);
        }

        .share-action-btn.secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .share-action-btn.secondary:hover {
            background: var(--bg-sidebar);
        }

        /* 设置页面样式 */
        .settings-section {
            margin-bottom: 24px;
        }

        .settings-section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 12px;
            margin-bottom: 8px;
        }

        .settings-item-info {
            flex: 1;
        }

        .settings-item-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .settings-item-desc {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .toggle-switch {
            position: relative;
            width: 48px;
            height: 28px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--border);
            transition: 0.3s;
            border-radius: 28px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        .toggle-switch input:checked + .toggle-slider {
            background: var(--primary);
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }

        .danger-btn {
            width: 100%;
            padding: 12px 24px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .danger-btn:hover {
            background: #dc2626;
        }

        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .btn-secondary {
            padding: 10px 20px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--bg-sidebar);
        }

        .btn-primary {
            padding: 10px 20px;
            background: var(--primary);
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        /* 响应式 */
        @media (max-width: 768px) {
            .sidebar {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                z-index: 100;
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .menu-toggle {
                display: block;
            }

            .chat-container {
                padding: 16px;
            }

            .input-container {
                padding: 16px;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                grid-template-columns: 1fr;
            }

            .share-card {
                padding: 36px 32px;
            }

            .share-card-idea {
                font-size: 26px;
            }

            .share-card-stats {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .share-stat {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 16px 20px;
            }

            .share-stat-value {
                font-size: 28px;
            }

            .share-stat-label {
                font-size: 13px;
            }

            .report-buttons {
                flex-direction: column;
            }
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-tertiary);
        }

        /* Tab 切换样式 */
        .report-tabs {
            display: flex;
            gap: 8px;
            border-bottom: 2px solid var(--border);
            margin-bottom: 24px;
        }

        .report-tab {
            padding: 12px 24px;
            background: none;
            border: none;
            font-size: 15px;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
            border-radius: 8px 8px 0 0;
        }

        .report-tab:hover {
            color: var(--primary);
            background: var(--bg-secondary);
        }

        .report-tab.active {
            color: var(--primary);
            background: var(--bg-secondary);
        }

        .report-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary);
        }

        .report-tab-content {
            display: none;
        }

        .report-tab-content.active {
            display: block;
        }

        /* 全局洞察样式 */
        .global-insights {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 32px;
            color: white;
        }

        .global-insights-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .global-insights-content {
            font-size: 14px;
            line-height: 1.8;
            opacity: 0.95;
        }

        .global-insights-content strong {
            display: block;
            margin-top: 12px;
            margin-bottom: 6px;
            font-weight: 600;
        }

        /* 文档章节样式 */
        .document-chapter {
            margin-bottom: 48px;
            padding-bottom: 32px;
            border-bottom: 1px solid var(--border);
        }

        .document-chapter:last-child {
            border-bottom: none;
        }

        .chapter-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .chapter-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: var(--primary);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .chapter-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .chapter-content {
            padding-left: 48px;
        }

        .chapter-content p {
            font-size: 15px;
            line-height: 1.8;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .chapter-content h4 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-top: 20px;
            margin-bottom: 12px;
        }

        .chapter-content ul {
            margin: 12px 0;
            padding-left: 24px;
        }

        .chapter-content li {
            font-size: 14px;
            line-height: 1.8;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .chapter-content strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .highlight-box {
            background: var(--bg-secondary);
            border-left: 4px solid var(--primary);
            padding: 16px 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .highlight-box strong {
            display: block;
            color: var(--primary);
            font-size: 15px;
            margin-bottom: 8px;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }

        .data-row:last-child {
            border-bottom: none;
        }

        .data-label {
            font-weight: 600;
            color: var(--text-primary);
        }

        .data-value {
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">ThinkCraft</div>
                <button class="new-chat-btn" onclick="startNewChat()">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                    </svg>
                    新建对话
                </button>
            </div>
            <div class="chat-history" id="chatHistory"></div>
        </aside>

        <main class="main-content">
            <header class="main-header">
                <button class="menu-toggle" onclick="toggleSidebar()">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
                <div class="main-title" id="mainTitle">ThinkCraft AI</div>
                <div class="header-actions">
                    <button class="icon-btn" onclick="showSettings()" title="设置">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                    </button>
                </div>
            </header>

            <div class="chat-container" id="chatContainer">
                <div class="empty-state" id="emptyState">
                    <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                    </svg>
                    <div class="empty-title">苏格拉底式思维引导</div>
                    <div class="empty-subtitle">通过深度提问，帮助你理清创意思路、发现盲点、形成结构化洞察</div>
                    <!-- 快速开始卡片已隐藏 -->
                </div>
                <div id="messageList" style="display: none;"></div>
            </div>

            <div class="input-container">
                <div class="input-wrapper">
                    <!-- 工具栏已隐藏 -->
                    <div class="input-box">
                        <textarea
                            class="main-input"
                            id="mainInput"
                            placeholder="分享你的创意想法，让我们通过深度对话来探索它的可能性..."
                            rows="1"
                            onkeydown="handleKeyDown(event)"
                            oninput="autoResize(this)"
                        ></textarea>
                        <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 详细报告模态框 -->
    <div class="modal" id="reportModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">详细分析报告</div>
                <button class="close-btn" onclick="closeReport()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>

            <div class="modal-body" id="reportContent">
                <!-- 报告内容将动态插入 -->
            </div>

            <div class="modal-footer">
                <button class="btn-secondary" onclick="exportFullReport()">导出PDF</button>
                <button class="btn-primary" onclick="generateShareLink()">生成分享链接</button>
            </div>
        </div>
    </div>

    <!-- 分享卡片模态框 -->
    <div class="modal" id="shareModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">创意分享</div>
                <button class="close-btn" onclick="closeShareModal()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>

            <div class="modal-body">
                <div class="share-card-container">
                    <div class="share-card" id="shareCard">
                        <div class="share-card-header">
                            <div class="share-card-logo">ThinkCraft</div>
                            <div class="share-card-badge">AI 分析</div>
                        </div>
                        <div class="share-card-main">
                            <div class="share-card-label">我的创意</div>
                            <div class="share-card-idea" id="shareIdeaTitle">创意验证工具</div>
                            <div class="share-card-tags">
                                <div class="share-tag" id="shareTag1">创业想法</div>
                                <div class="share-tag" id="shareTag2">AI工具</div>
                            </div>
                        </div>
                        <div class="share-card-stats">
                            <div class="share-stat">
                                <div>
                                    <div class="share-stat-value">85</div>
                                    <div class="share-stat-label">可行性</div>
                                </div>
                            </div>
                            <div class="share-stat">
                                <div>
                                    <div class="share-stat-value">78</div>
                                    <div class="share-stat-label">创新性</div>
                                </div>
                            </div>
                            <div class="share-stat">
                                <div>
                                    <div class="share-stat-value">92</div>
                                    <div class="share-stat-label">市场潜力</div>
                                </div>
                            </div>
                        </div>
                        <div class="share-card-footer">
                            <div class="share-card-footer-text">
                                <div class="share-card-footer-label">生成时间</div>
                                <div class="share-cta" id="shareDate">2026-01-09</div>
                            </div>
                            <div class="share-qr"></div>
                        </div>
                    </div>
                    <div class="share-actions">
                        <button class="share-action-btn secondary" onclick="downloadCard()">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                            </svg>
                            下载图片
                        </button>
                        <button class="share-action-btn primary" onclick="copyShareText()">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                            复制文案
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 设置模态框 -->
    <div class="modal" id="settingsModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <div class="modal-title">设置</div>
                <button class="close-btn" onclick="closeSettings()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>

            <div class="modal-body">
                <div class="settings-section">
                    <div class="settings-section-title">外观</div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">暗色模式</div>
                            <div class="settings-item-desc">切换为深色主题</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="settings-section-title">数据管理</div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">保存历史记录</div>
                            <div class="settings-item-desc">自动保存对话到本地</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="saveHistoryToggle" checked onchange="toggleSaveHistory()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div style="margin-top: 16px;">
                        <button class="danger-btn" onclick="clearAllHistory()">清除所有历史记录</button>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="settings-section-title">关于</div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-title">ThinkCraft v2.0</div>
                            <div class="settings-item-desc">AI思维助手 · 将灵感转化为洞察</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- 系统提示词配置 -->
    <script src="config/system-prompts.js"></script>
    <script>
        const state = {
            currentChat: null,
            chats: [],
            messages: [],
            isTyping: false,
            isLoading: false,
            settings: {
                darkMode: false,
                saveHistory: true,
                apiUrl: 'http://localhost:3000'
            }
        };

        // 系统提示词 - 从配置文件加载
        // 修改提示词：编辑 config/system-prompts.js 文件
        // 切换预设：修改配置文件中的 DEFAULT_PROMPT 变量
        const SYSTEM_PROMPT = window.SYSTEM_PROMPTS
            ? window.SYSTEM_PROMPTS[window.DEFAULT_PROMPT]
            : `你是ThinkCraft AI思维助手，专业的创意分析和验证工具。

你的使命：
- 帮助用户系统地分析和验证想法
- 提出建设性的问题和洞察
- 生成结构化的分析报告

交互风格：
- 友好但专业，循序渐进
- 基于用户反馈灵活调整
- 每次只问1-2个问题，避免信息过载

当用户提出创意时，你应该逐步引导他们思考：
1. 核心想法是什么？
2. 目标用户是谁？他们的痛点是什么？
3. 解决方案有什么独特之处？
4. 如何验证这个想法的可行性？
5. 有哪些关键指标可以衡量成功？

始终保持建设性态度，鼓励用户深度思考。`;



        document.addEventListener('DOMContentLoaded', () => {
            loadChats();
            loadSettings();
            focusInput();
        });

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        function handleKeyDown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        }

        function quickStart(type) {
            const prompts = {
                '创业想法': '我有一个创业想法，想验证一下可行性',
                '产品功能': '我在思考一个产品功能，需要分析一下',
                '解决方案': '我遇到了一个问题，想找到最佳解决方案',
                '职业发展': '我在考虑职业发展方向，需要规划一下'
            };
            document.getElementById('mainInput').value = prompts[type];
            sendMessage();
        }

        async function sendMessage() {
            const input = document.getElementById('mainInput');
            const message = input.value.trim();

            if (!message || state.isTyping || state.isLoading) return;

            document.getElementById('emptyState').style.display = 'none';
            document.getElementById('messageList').style.display = 'block';

            // 添加用户消息
            addMessage('user', message);
            input.value = '';
            input.style.height = 'auto';

            // 将消息添加到state.messages
            state.messages.push({
                role: 'user',
                content: message
            });

            // 设置加载状态
            state.isLoading = true;

            try {
                // 调用后端API
                const response = await fetch(`${state.settings.apiUrl}/api/chat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        messages: state.messages.map(m => ({
                            role: m.role,
                            content: m.content
                        })),
                        systemPrompt: SYSTEM_PROMPT
                    })
                });

                if (!response.ok) {
                    throw new Error(`API错误: ${response.status}`);
                }

                const data = await response.json();

                if (data.code !== 0) {
                    throw new Error(data.error || '未知错误');
                }

                const aiContent = data.data.content;

                // 将AI回复添加到state.messages
                state.messages.push({
                    role: 'assistant',
                    content: aiContent
                });

                // 显示AI回复（带打字机效果）
                handleAPIResponse(aiContent);

                // 自动保存对话
                if (state.settings.saveHistory) {
                    saveCurrentChat();
                }

            } catch (error) {
                console.error('API调用失败:', error);
                const errorMsg = `抱歉，出现了错误：${error.message}\n\n请检查：\n1. 后端服务是否已启动（npm start）\n2. .env文件中的DEEPSEEK_API_KEY是否配置正确\n3. 网络连接是否正常`;
                addMessage('assistant', errorMsg);
            } finally {
                state.isLoading = false;
            }
        }

        function handleAPIResponse(content) {
            const messageList = document.getElementById('messageList');
            const time = new Date().toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });

            const messageDiv = document.createElement('div');
            messageDiv.className = 'message assistant';
            messageDiv.innerHTML = `
                <div class="message-avatar">🤖</div>
                <div class="message-content">
                    <div class="message-header">
                        <span class="message-role">ThinkCraft</span>
                        <span class="message-time">${time}</span>
                    </div>
                    <div class="message-text" id="typing-${Date.now()}"></div>
                </div>
            `;
            messageList.appendChild(messageDiv);

            const textElement = messageDiv.querySelector('.message-text');
            typeWriter(textElement, content, 30);  // 保留打字机效果

            scrollToBottom();
        }

        function addMessage(role, content, quickReplies = null, showButtons = false) {
            const messageList = document.getElementById('messageList');
            const time = new Date().toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });

            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;

            const avatar = role === 'user' ? '👤' : '🤖';
            const roleName = role === 'user' ? '你' : 'ThinkCraft';

            let html = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">
                    <div class="message-header">
                        <span class="message-role">${roleName}</span>
                        <span class="message-time">${time}</span>
                    </div>
            `;

            if (role === 'assistant' && !showButtons) {
                html += `<div class="message-text" id="typing-${Date.now()}"></div>`;
                messageDiv.innerHTML = html + '</div>';
                messageList.appendChild(messageDiv);

                const textElement = messageDiv.querySelector('.message-text');
                typeWriter(textElement, content, 30);
            } else {
                html += `<div class="message-text">${content}</div>`;
            }

            if (quickReplies) {
                html += '<div class="message-actions">';
                quickReplies.forEach(reply => {
                    html += `<button class="action-chip" onclick="quickReply('${reply}')">${reply}</button>`;
                });
                html += '</div>';
            }

            if (showButtons) {
                html += `
                    <div class="report-buttons">
                        <button class="view-report-btn" onclick="viewReport()">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                            查看完整报告
                        </button>
                        <button class="share-btn" onclick="showShareCard()">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                            </svg>
                            创意分享
                        </button>
                    </div>
                `;
            }

            html += '</div>';

            if (role === 'user' || showButtons) {
                messageDiv.innerHTML = html;
                messageList.appendChild(messageDiv);
            }

            scrollToBottom();
            state.messages.push({ role, content, time });
        }

        function typeWriter(element, text, speed = 30) {
            state.isTyping = true;
            let i = 0;
            const timer = setInterval(() => {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                    scrollToBottom();
                } else {
                    clearInterval(timer);
                    state.isTyping = false;
                }
            }, speed);
        }

        function quickReply(text) {
            document.getElementById('mainInput').value = text;
            sendMessage();
        }

        function scrollToBottom() {
            const container = document.getElementById('chatContainer');
            container.scrollTop = container.scrollHeight;
        }

        function focusInput() {
            document.getElementById('mainInput').focus();
        }

        function startNewChat() {
            if (state.conversationStep > 0) {
                if (!confirm('确定要开始新对话吗？当前对话将被保存到历史记录。')) {
                    return;
                }
                saveCurrentChat();
            }

            state.currentChat = null;
            state.messages = [];
            state.conversationStep = 0;
            state.userData = {};

            document.getElementById('emptyState').style.display = 'flex';
            document.getElementById('messageList').style.display = 'none';
            document.getElementById('messageList').innerHTML = '';

            focusInput();
        }

        function saveCurrentChat() {
            if (!state.settings.saveHistory || state.messages.length === 0) return;

            // 从第一条用户消息提取标题
            let title = '新对话';
            const firstUserMsg = state.messages.find(m => m.role === 'user');
            if (firstUserMsg) {
                title = firstUserMsg.content.substring(0, 30);
                if (firstUserMsg.content.length > 30) {
                    title += '...';
                }
            }

            const chat = {
                id: Date.now(),
                title: title,
                messages: [...state.messages],
                createdAt: new Date().toISOString()
            };
            state.chats.unshift(chat);
            localStorage.setItem('thinkcraft_chats', JSON.stringify(state.chats));
            loadChats();
        }

        function loadChats() {
            const saved = localStorage.getItem('thinkcraft_chats');
            if (saved) {
                state.chats = JSON.parse(saved);
            }

            // 排序：置顶的在前，然后按时间倒序
            state.chats.sort((a, b) => {
                if (a.isPinned && !b.isPinned) return -1;
                if (!a.isPinned && b.isPinned) return 1;
                return new Date(b.createdAt) - new Date(a.createdAt);
            });

            const historyDiv = document.getElementById('chatHistory');
            historyDiv.innerHTML = '';

            if (state.chats.length === 0) {
                historyDiv.innerHTML = '<div style="padding: 12px; text-align: center; color: var(--text-tertiary); font-size: 13px;">暂无历史记录</div>';
                return;
            }

            state.chats.forEach(chat => {
                const item = document.createElement('div');
                item.className = 'chat-item' + (chat.isPinned ? ' pinned' : '') + (state.currentChat === chat.id ? ' active' : '');
                item.innerHTML = `
                    <svg class="chat-item-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"/>
                    </svg>
                    <span class="chat-item-content" onclick="loadChat(${chat.id})">${chat.title}</span>
                    <div class="chat-item-actions">
                        <button class="chat-item-more" onclick="toggleChatMenu(event, ${chat.id})">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
                            </svg>
                        </button>
                        <div class="chat-item-menu" id="menu-${chat.id}">
                            <div class="chat-item-menu-item" onclick="renameChat(event, ${chat.id})">
                                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                                重命名
                            </div>
                            <div class="chat-item-menu-item" onclick="togglePinChat(event, ${chat.id})">
                                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"/>
                                </svg>
                                ${chat.isPinned ? '取消置顶' : '置顶'}
                            </div>
                            <div class="chat-item-menu-item danger" onclick="deleteChat(event, ${chat.id})">
                                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                                删除
                            </div>
                        </div>
                    </div>
                `;
                historyDiv.appendChild(item);
            });
        }

        function toggleChatMenu(e, chatId) {
            e.stopPropagation();
            const menu = document.getElementById(`menu-${chatId}`);

            // 关闭所有其他菜单
            document.querySelectorAll('.chat-item-menu').forEach(m => {
                if (m.id !== `menu-${chatId}`) {
                    m.classList.remove('active');
                }
            });

            menu.classList.toggle('active');
        }

        function renameChat(e, chatId) {
            e.stopPropagation();
            const chat = state.chats.find(c => c.id === chatId);
            if (!chat) return;

            const newTitle = prompt('修改对话标题', chat.title);
            if (newTitle && newTitle.trim()) {
                chat.title = newTitle.trim();
                localStorage.setItem('thinkcraft_chats', JSON.stringify(state.chats));
                loadChats();
            }

            document.getElementById(`menu-${chatId}`).classList.remove('active');
        }

        function togglePinChat(e, chatId) {
            e.stopPropagation();
            const chat = state.chats.find(c => c.id === chatId);
            if (!chat) return;

            chat.isPinned = !chat.isPinned;
            localStorage.setItem('thinkcraft_chats', JSON.stringify(state.chats));
            loadChats();

            document.getElementById(`menu-${chatId}`).classList.remove('active');
        }

        function deleteChat(e, chatId) {
            e.stopPropagation();

            if (!confirm('确定要删除这个对话吗？此操作不可恢复。')) {
                document.getElementById(`menu-${chatId}`).classList.remove('active');
                return;
            }

            state.chats = state.chats.filter(c => c.id !== chatId);
            localStorage.setItem('thinkcraft_chats', JSON.stringify(state.chats));

            // 如果删除的是当前对话，重置状态
            if (state.currentChat === chatId) {
                state.currentChat = null;
                state.messages = [];
                state.conversationStep = 0;
                state.userData = {};
                document.getElementById('emptyState').style.display = 'flex';
                document.getElementById('messageList').style.display = 'none';
                document.getElementById('messageList').innerHTML = '';
            }

            loadChats();
        }

        // 点击页面其他地方关闭所有菜单
        document.addEventListener('click', () => {
            document.querySelectorAll('.chat-item-menu').forEach(menu => {
                menu.classList.remove('active');
            });
        });

        function loadChat(id) {
            const chat = state.chats.find(c => c.id === id);
            if (!chat) return;

            state.currentChat = id;
            state.messages = [...chat.messages];
            state.userData = {...chat.userData};
            state.conversationStep = conversationFlow.length + 1;

            document.getElementById('emptyState').style.display = 'none';
            const messageList = document.getElementById('messageList');
            messageList.style.display = 'block';
            messageList.innerHTML = '';

            chat.messages.forEach(msg => {
                addMessage(msg.role, msg.content);
            });
        }

        // 查看报告
        async function viewReport() {
            await generateDetailedReport();
            document.getElementById('reportModal').classList.add('active');
        }

        // 生成详细报告（AI驱动）
        async function generateDetailedReport() {
            const reportContent = document.getElementById('reportContent');

            // 检查是否有足够的对话历史
            if (state.messages.length < 2) {
                reportContent.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">📝</div>
                        <div style="font-size: 18px; font-weight: 600; color: var(--text-primary); margin-bottom: 12px;">
                            对话内容不足
                        </div>
                        <div style="font-size: 14px; color: var(--text-secondary);">
                            请先与AI进行至少一轮完整的对话，然后再生成分析报告。
                        </div>
                    </div>
                `;
                return;
            }

            // 显示加载状态
            reportContent.innerHTML = `
                <div style="text-align: center; padding: 60px 20px;">
                    <div style="font-size: 48px; margin-bottom: 20px;">🤖</div>
                    <div style="font-size: 18px; font-weight: 600; color: var(--text-primary); margin-bottom: 12px;">
                        AI正在生成分析报告...
                    </div>
                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 20px;">
                        这可能需要10-20秒，请稍候
                    </div>
                    <div class="score-bar" style="max-width: 300px; margin: 0 auto;">
                        <div class="score-track">
                            <div class="score-fill" style="width: 0%; animation: loading 2s infinite;"></div>
                        </div>
                    </div>
                </div>
                <style>
                    @keyframes loading {
                        0% { width: 0%; }
                        50% { width: 70%; }
                        100% { width: 100%; }
                    }
                </style>
            `;

            try {
                // 调用后端API生成报告
                const response = await fetch(`${state.settings.apiUrl}/api/report/generate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        messages: state.messages
                    })
                });

                if (!response.ok) {
                    throw new Error(`API错误: ${response.status}`);
                }

                const data = await response.json();

                if (data.code !== 0) {
                    throw new Error(data.error || '未知错误');
                }

                const reportData = data.data.report;

                // 渲染AI生成的报告
                renderAIReport(reportData);

            } catch (error) {
                console.error('报告生成失败:', error);
                reportContent.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">⚠️</div>
                        <div style="font-size: 18px; font-weight: 600; color: var(--text-primary); margin-bottom: 12px;">
                            报告生成失败
                        </div>
                        <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 20px;">
                            ${error.message}
                        </div>
                        <button class="btn-primary" onclick="generateDetailedReport()">重试</button>
                    </div>
                `;
            }
        }

        // 渲染AI生成的报告
        function renderAIReport(reportData) {
            const reportContent = document.getElementById('reportContent');

            const ch1 = reportData.chapters.chapter1;
            const ch2 = reportData.chapters.chapter2;
            const ch3 = reportData.chapters.chapter3;
            const ch4 = reportData.chapters.chapter4;
            const ch5 = reportData.chapters.chapter5;
            const ch6 = reportData.chapters.chapter6;

            reportContent.innerHTML = `
                <!-- Tab 切换 -->
                <div class="report-tabs">
                    <button class="report-tab active" onclick="switchReportTab('insights')">
                        🧠 创意思维分析报告
                    </button>
                </div>

                <!-- 创意思维分析报告内容 -->
                    <button class="report-tab active" onclick="switchReportTab('insights')">
                        🤖 AI深度洞察
                    </button>
                    <button class="report-tab" onclick="switchReportTab('business')">
                        📘 商业计划书
                    </button>
                    <button class="report-tab" onclick="switchReportTab('product')">
                        📝 产品立项材料
                    </button>
                </div>

                <!-- AI深度洞察内容 -->
                <div id="insights-plan" class="report-tab-content active">
                    <!-- 顶部全局摘要 -->
                    <div class="global-insights">
                        <div class="global-insights-title">
                            🤖 AI 全局决策建议
                        </div>
                        <div class="global-insights-content">
                            作为你的AI思维伙伴，我已对你的创意"<strong>${state.userData.initialIdea || '创意验证工具'}</strong>"进行了系统性的六维度深度分析。这不是一份简单的总结，而是一份<strong>结构化的决策支持报告</strong>，旨在将模糊的对话转化为可验证的假设、可评估的风险和可执行的行动计划。
                            <strong>核心发现</strong>
                            你的创意本质是：<strong>用${state.userData.solution || '创新方法'}，为${state.userData.targetUser || '目标群体'}，解决${state.userData.problem || '核心问题'}</strong>。经过多维度交叉验证，这是一个<strong>高潜力但需要验证</strong>的机会窗口。
                            <strong>阅读指南</strong>
                            下方六个维度将从逻辑解码、商业价值、风险预判、思维模式、创造性延伸和执行规划六个角度，帮助你全面理解这个创意的潜力与挑战。建议按顺序阅读，每个部分都包含可行动的洞察。
                        </div>
                    </div>

                    <!-- 1. 语义与逻辑解码层 -->
                    <div class="report-section">
                        <div class="report-section-title">📋 一、语义与逻辑解码（基础分析）</div>

                        <div class="document-chapter">
                            <div class="chapter-content" style="padding-left: 0;">
                                <h4>核心意图提取</h4>
                                <div class="highlight-box">
                                    <strong>本质定义</strong>
                                    这本质上是一个关于<strong>【用${state.userData.solution || '某种方法'}，为${state.userData.targetUser || '某类人群'}，解决${state.userData.problem || '某个问题'}】</strong>的创意。这是一个典型的"痛点驱动型"产品构想，核心假设是：目标用户群体存在明确的未被满足的需求，且愿意为解决方案付费。
                                </div>

                                <h4>论点与论据映射</h4>
                                <ul>
                                    <li><strong>核心主张：</strong>"${state.userData.initialIdea || '这个产品有价值'}"</li>
                                    <li><strong>支持论据：</strong>
                                        <ul>
                                            <li>目标用户"${state.userData.targetUser || '某群体'}"确实存在"${state.userData.problem || '某个问题'}"</li>
                                            <li>现有解决方案存在不足，市场有空白</li>
                                            <li>提出的解决方案"${state.userData.solution || '某方案'}"具有差异化优势</li>
                                            <li>存在可量化的验证指标"${state.userData.validation || '某些指标'}"</li>
                                        </ul>
                                    </li>
                                    <li><strong>逻辑强度评估：</strong>论据链条基本成立，但需要通过实际数据验证每个环节的强度。</li>
                                </ul>

                                <h4>信息完整性评估</h4>
                                <div class="analysis-grid">
                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon">✅</div>
                                            <div class="analysis-card-title">已明确信息</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>目标用户画像</li>
                                                <li>核心痛点描述</li>
                                                <li>解决方案思路</li>
                                                <li>成功验证指标</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon">❓</div>
                                            <div class="analysis-card-title">待澄清问题</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>用户为什么现在不能解决这个问题？</li>
                                                <li>你的解决方案的核心竞争力是什么？</li>
                                                <li>预期的盈利模式是什么？</li>
                                                <li>需要哪些关键资源才能启动？</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2. 商业与价值洞察层 -->
                    <div class="report-section">
                        <div class="report-section-title">💎 二、商业与价值洞察（核心分析）</div>

                        <div class="document-chapter">
                            <div class="chapter-content" style="padding-left: 0;">
                                <h4>用户与场景洞察</h4>
                                <p><strong>人物画像模拟：</strong></p>
                                <div class="highlight-box">
                                    基于你的描述，目标用户"${state.userData.targetUser || '目标群体'}"的典型画像可能是：
                                    <ul style="margin-top: 12px; margin-bottom: 0;">
                                        <li><strong>人口特征：</strong>25-40岁，知识工作者，本科及以上学历</li>
                                        <li><strong>行为特征：</strong>对效率工具敏感，有一定学习能力，活跃于线上社区</li>
                                        <li><strong>深层动机：</strong>除了解决"${state.userData.problem || '表面问题'}"，他们可能更深层的需求是"提升专业能力"或"建立竞争优势"</li>
                                        <li><strong>付费能力：</strong>月收入可能在8K-30K区间，对合理定价的工具有付费意愿</li>
                                    </ul>
                                </div>

                                <p><strong>场景还原与痛点分级：</strong></p>
                                <p>将"${state.userData.problem || '用户问题'}"置于具体场景：</p>
                                <ul>
                                    <li><strong>典型场景：</strong>用户在【工作/生活】中遇到【具体情境】，需要快速做出决策或完成任务</li>
                                    <li><strong>痛点频率：</strong>预估为【每周/每月】1-3次的中高频需求</li>
                                    <li><strong>痛点强度：</strong>这是一个【中等强度】的痛点，用户会感到不便但可以通过替代方案勉强应对</li>
                                    <li><strong>解决意愿：</strong>如果有完美解决方案，用户愿意付出【时间成本/金钱成本】来获取</li>
                                </ul>

                                <h4>需求与问题诊断</h4>
                                <div class="analysis-grid">
                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon">🎯</div>
                                            <div class="analysis-card-title">真伪需求判别</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <p><strong>表面需求：</strong>"${state.userData.problem || '用户说的问题'}"</p>
                                            <p><strong>本质需求：</strong>用户真正想要的可能是"更快的决策能力"、"更高的工作效率"或"更强的专业自信"。</p>
                                            <p><strong>建议：</strong>在用户访谈中，用"5 Whys"方法挖掘更深层的动机。</p>
                                        </div>
                                    </div>

                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon">💰</div>
                                            <div class="analysis-card-title">问题价值量化</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <p><strong>时间成本：</strong>假设用户每次花费30-60分钟处理这个问题，每月3次，相当于2-3小时/月。</p>
                                            <p><strong>机会成本：</strong>按人均时薪150元计算，每月损失约300-450元。</p>
                                            <p><strong>结论：</strong>如果你的解决方案定价在100元/月以内，用户会感觉"物超所值"。</p>
                                        </div>
                                    </div>
                                </div>

                                <h4>解决方案与模式评估</h4>
                                <p><strong>方案匹配度分析：</strong></p>
                                <ul>
                                    <li><strong>核心方案：</strong>"${state.userData.solution || '你的解决方案'}"</li>
                                    <li><strong>匹配度：</strong>该方案【直接/间接】解决了核心问题，匹配度约【75-85%】</li>
                                    <li><strong>潜在缺陷：</strong>可能存在【学习成本过高】或【功能过度设计】的风险</li>
                                    <li><strong>优化方向：</strong>建议先聚焦核心功能，降低首次使用门槛</li>
                                </ul>

                                <p><strong>商业模式推演：</strong></p>
                                <div class="highlight-box">
                                    <strong>推荐模式：SaaS订阅制</strong>
                                    <ul style="margin-top: 12px; margin-bottom: 0;">
                                        <li><strong>免费版：</strong>提供基础功能，每月3次使用限制，用于获客和口碑传播</li>
                                        <li><strong>专业版（$9.9/月）：</strong>无限使用+高级功能，目标转化率5-10%</li>
                                        <li><strong>企业版（$29.9/月）：</strong>团队协作+定制服务，面向B端客户</li>
                                        <li><strong>收入预测：</strong>1000用户×5%转化×$10客单价 = $500 MRR（首年目标）</li>
                                    </ul>
                                </div>

                                <h4>市场与竞争定位</h4>
                                <p><strong>类比竞品定位：</strong></p>
                                <div class="data-row">
                                    <span class="data-label">类似产品</span>
                                    <span class="data-value">Notion AI、Miro、传统咨询工具</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">市场定位</span>
                                    <span class="data-value">垂直场景AI工具，介于通用AI和专业咨询之间</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">价格定位</span>
                                    <span class="data-value">中低端（$10-30/月），避开高端市场竞争</span>
                                </div>

                                <p><strong>差异化机会点挖掘：</strong></p>
                                <ul>
                                    <li><strong>用户体验差异：</strong>对话式交互 vs 传统的表单填写</li>
                                    <li><strong>技术路径差异：</strong>AI驱动 vs 模板驱动</li>
                                    <li><strong>客群差异：</strong>聚焦个人用户 vs 企业客户</li>
                                    <li><strong>方法论差异：</strong>内置专业框架（五看三定、SWOT）vs 通用分析</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- 3. 风险与可行性预判层 -->
                    <div class="report-section">
                        <div class="report-section-title">⚠️ 三、风险与可行性预判（防御性分析）</div>

                        <div class="document-chapter">
                            <div class="chapter-content" style="padding-left: 0;">
                                <h4>风险雷达扫描</h4>
                                <div class="analysis-grid">
                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon" style="background: #ef4444;">📉</div>
                                            <div class="analysis-card-title">市场风险</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <p><strong>风险等级：中</strong></p>
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>目标市场规模可能小于预期</li>
                                                <li>用户付费意愿需要验证</li>
                                                <li>市场教育成本可能较高</li>
                                            </ul>
                                            <p style="margin-top: 8px;"><strong>应对：</strong>先做小范围MVP测试，验证核心假设后再规模化投入。</p>
                                        </div>
                                    </div>

                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon" style="background: #f59e0b;">⚙️</div>
                                            <div class="analysis-card-title">技术风险</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <p><strong>风险等级：低</strong></p>
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>依赖第三方AI模型API</li>
                                                <li>模型成本可能上涨</li>
                                                <li>输出质量需持续优化</li>
                                            </ul>
                                            <p style="margin-top: 8px;"><strong>应对：</strong>选择多个模型供应商，优化Prompt工程，建立缓存机制。</p>
                                        </div>
                                    </div>

                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon" style="background: #8b5cf6;">🎯</div>
                                            <div class="analysis-card-title">执行风险</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <p><strong>风险等级：中</strong></p>
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>小团队资源有限</li>
                                                <li>产品、运营、技术需同步推进</li>
                                                <li>冷启动获客难度大</li>
                                            </ul>
                                            <p style="margin-top: 8px;"><strong>应对：</strong>聚焦核心功能，利用社区运营实现低成本获客，善用外部资源。</p>
                                        </div>
                                    </div>

                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon" style="background: #06b6d4;">⚖️</div>
                                            <div class="analysis-card-title">合规风险</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <p><strong>风险等级：低</strong></p>
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>用户数据隐私保护</li>
                                                <li>AI生成内容的责任归属</li>
                                                <li>可能涉及的行业监管</li>
                                            </ul>
                                            <p style="margin-top: 8px;"><strong>应对：</strong>建立严格的数据安全机制，明确用户协议，关注政策动向。</p>
                                        </div>
                                    </div>
                                </div>

                                <h4>资源与能力审计</h4>
                                <div class="highlight-box">
                                    <strong>关键资源需求清单</strong>
                                    <ul style="margin-top: 12px; margin-bottom: 0;">
                                        <li><strong>核心团队：</strong>产品经理1名 + 全栈工程师1-2名 + 运营1名</li>
                                        <li><strong>技术资源：</strong>AI模型API（$500-1000/月）+ 云服务器（$200-500/月）</li>
                                        <li><strong>启动资金：</strong>50-100万人民币（种子轮），可支撑12-18个月</li>
                                        <li><strong>关键合作伙伴：</strong>AI模型供应商、技术社区、早期KOL</li>
                                        <li><strong>时间投入：</strong>全职投入至少6个月，达到产品市场匹配（PMF）</li>
                                    </ul>
                                </div>

                                <h4>可行性综合评估</h4>
                                <div class="data-row">
                                    <span class="data-label">技术可行性</span>
                                    <span class="data-value" style="color: #10b981; font-weight: 600;">✅ 高（基于成熟API，开发周期短）</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">商业可行性</span>
                                    <span class="data-value" style="color: #f59e0b; font-weight: 600;">⚠️ 中（需求明确但需验证付费意愿）</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">资源可行性</span>
                                    <span class="data-value" style="color: #10b981; font-weight: 600;">✅ 高（所需资源适中，风险可控）</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">时间窗口</span>
                                    <span class="data-value" style="color: #f59e0b; font-weight: 600;">⚠️ 有限（6-12个月窗口期）</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 4. 对话元认知层 -->
                    <div class="report-section">
                        <div class="report-section-title">🧠 四、对话元认知分析（过程洞察）</div>

                        <div class="document-chapter">
                            <div class="chapter-content" style="padding-left: 0;">
                                <h4>思维模式识别</h4>
                                <div class="highlight-box">
                                    <strong>你的思维特征画像</strong>
                                    <p style="margin-top: 12px;">基于你的对话内容和表达方式，我识别出以下思维倾向：</p>
                                    <ul style="margin-top: 12px; margin-bottom: 0;">
                                        <li><strong>问题导向型：</strong>你从明确的痛点出发，这是好的产品思维起点</li>
                                        <li><strong>解决方案导向：</strong>你对如何解决问题有清晰的构想，显示出较强的执行力</li>
                                        <li><strong>验证意识强：</strong>你主动提出了验证指标"${state.userData.validation || '某些指标'}"，说明你理解精益创业的重要性</li>
                                        <li><strong>建议：</strong>保持这种平衡，但要警惕"解决方案执念"，随时准备根据用户反馈调整方向</li>
                                    </ul>
                                </div>

                                <h4>情绪与信心指数</h4>
                                <div class="score-bar">
                                    <div class="score-label">
                                        <span>对创意的信心程度</span>
                                        <span style="color: var(--primary); font-weight: 600;">75%</span>
                                    </div>
                                    <div class="score-track">
                                        <div class="score-fill" style="width: 75%"></div>
                                    </div>
                                </div>
                                <p style="margin-top: 8px; font-size: 14px; color: var(--text-secondary);">
                                    你在描述创意时展现了<strong>适度的信心</strong>，这是健康的状态。既不过度乐观（可能忽视风险），也不过于谨慎（可能错失机会）。这种态度有利于在执行中保持理性判断。
                                </p>

                                <h4>认知盲区提示</h4>
                                <div class="analysis-grid">
                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon">❗</div>
                                            <div class="analysis-card-title">你可能忽略的关键问题</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li><strong>冷启动策略：</strong>对话中未提及如何获取前100个用户，这通常是最难的环节</li>
                                                <li><strong>留存机制：</strong>如何让用户持续使用而不是"用完即走"？</li>
                                                <li><strong>盈利路径：</strong>具体的定价策略和商业模式尚不明确</li>
                                                <li><strong>竞争壁垒：</strong>如果大厂推出类似功能，你的护城河在哪里？</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon">💡</div>
                                            <div class="analysis-card-title">建议关注的深度问题</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>用户为什么现在不能解决这个问题？替代方案是什么？</li>
                                                <li>你的核心竞争力是速度、质量、价格还是体验？</li>
                                                <li>如果只能保留一个功能，你会选择哪个？为什么？</li>
                                                <li>最坏的情况是什么？你能承受吗？</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 5. 创造性延伸层 -->
                    <div class="report-section">
                        <div class="report-section-title">✨ 五、创造性延伸（生成性分析）</div>

                        <div class="document-chapter">
                            <div class="chapter-content" style="padding-left: 0;">
                                <h4>概念发散与联想</h4>
                                <p>基于你的核心创意，我尝试进行跨界联想和概念延伸：</p>

                                <div class="insight-item">
                                    <div class="insight-number">1</div>
                                    <div class="insight-text">
                                        <strong>教育场景延伸：</strong>如果将这个思维工具应用在【商学院教学】场景，它可以成为一个"案例分析辅导系统"，帮助学生快速掌握商业分析框架。潜在客户：MBA项目、企业培训机构。
                                    </div>
                                </div>

                                <div class="insight-item">
                                    <div class="insight-number">2</div>
                                    <div class="insight-text">
                                        <strong>企业内部工具化：</strong>这个工具可以定制为"企业内部创新评审系统"，员工提交创意后自动生成评估报告，帮助管理层快速筛选有价值的项目。潜在客户：创新型企业、孵化器。
                                    </div>
                                </div>

                                <div class="insight-item">
                                    <div class="insight-number">3</div>
                                    <div class="insight-text">
                                        <strong>投资人工具化：</strong>将框架调整为"项目尽调工具"，投资人输入项目信息后快速生成初步评估报告，提升筛选效率。潜在客户：早期投资机构、天使投资人。
                                    </div>
                                </div>

                                <div class="insight-item">
                                    <div class="insight-number">4</div>
                                    <div class="insight-text">
                                        <strong>API开放平台：</strong>不仅做C端产品，还可以将核心分析能力封装为API，集成到其他平台（如创业社区、项目管理工具），形成B2B2C模式。
                                    </div>
                                </div>

                                <h4>第一性原理反问</h4>
                                <div class="highlight-box">
                                    <strong>挑战性思考</strong>
                                    <p style="margin-top: 12px;">让我们回到最基本的原则，对核心假设进行挑战：</p>
                                    <ul style="margin-top: 12px; margin-bottom: 0;">
                                        <li><strong>我们是否必须用AI？</strong>如果去掉AI，用结构化的问卷+模板，是否也能达到80%的效果？AI的边际价值在哪里？</li>
                                        <li><strong>我们是否必须做工具？</strong>是否可以用"服务"的形式（如：按需咨询服务），先验证需求再产品化？</li>
                                        <li><strong>我们是否必须自己做？</strong>这个能力是否可以作为功能模块，集成到现有的大平台中（如Notion、飞书），通过插件/API的方式快速触达用户？</li>
                                        <li><strong>用户真正要的是什么？</strong>是"分析报告"这个结果，还是"做出正确决策"的安全感？如果是后者，是否有更直接的方式提供这种安全感？</li>
                                    </ul>
                                </div>

                                <h4>相邻可能性探索</h4>
                                <p>在你当前创意的基础上，还存在这些"相邻可能性"：</p>
                                <ul>
                                    <li><strong>垂直化：</strong>不做通用分析工具，专注某一个细分场景（如：SaaS产品创意验证、副业项目评估、投资项目筛选），建立领域专家形象</li>
                                    <li><strong>社区化：</strong>在工具基础上构建"创意验证社区"，用户可以互相查看、评论、投票彼此的分析报告，形成网络效应</li>
                                    <li><strong>游戏化：</strong>将分析过程设计为"闯关游戏"，每个维度是一关，通关后获得完整报告，提升用户参与度和完成率</li>
                                    <li><strong>教育化：</strong>不仅给出分析结果，更重要的是教会用户如何思考，附带"思维框架学习课程"，提升用户能力而不是依赖工具</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- 6. 整合与执行规划层 -->
                    <div class="report-section">
                        <div class="report-section-title">🎯 六、整合与执行规划（决策支持）</div>

                        <div class="document-chapter">
                            <div class="chapter-content" style="padding-left: 0;">
                                <h4>可行性综合评分</h4>
                                <div class="analysis-grid">
                                    <div class="analysis-card">
                                        <div class="analysis-card-content" style="text-align: center;">
                                            <div style="font-size: 48px; font-weight: 800; color: var(--primary); margin-bottom: 8px;">78</div>
                                            <div style="font-size: 14px; color: var(--text-secondary);">综合评分（满分100）</div>
                                        </div>
                                    </div>
                                </div>

                                <div style="margin-top: 24px;">
                                    <div class="score-bar">
                                        <div class="score-label">
                                            <span>市场机会</span>
                                            <span style="color: var(--primary); font-weight: 600;">82分</span>
                                        </div>
                                        <div class="score-track">
                                            <div class="score-fill" style="width: 82%"></div>
                                        </div>
                                    </div>

                                    <div class="score-bar">
                                        <div class="score-label">
                                            <span>技术可行性</span>
                                            <span style="color: var(--primary); font-weight: 600;">88分</span>
                                        </div>
                                        <div class="score-track">
                                            <div class="score-fill" style="width: 88%"></div>
                                        </div>
                                    </div>

                                    <div class="score-bar">
                                        <div class="score-label">
                                            <span>商业模式</span>
                                            <span style="color: var(--primary); font-weight: 600;">72分</span>
                                        </div>
                                        <div class="score-track">
                                            <div class="score-fill" style="width: 72%"></div>
                                        </div>
                                    </div>

                                    <div class="score-bar">
                                        <div class="score-label">
                                            <span>竞争壁垒</span>
                                            <span style="color: var(--primary); font-weight: 600;">68分</span>
                                        </div>
                                        <div class="score-track">
                                            <div class="score-fill" style="width: 68%"></div>
                                        </div>
                                    </div>

                                    <div class="score-bar">
                                        <div class="score-label">
                                            <span>执行难度</span>
                                            <span style="color: var(--primary); font-weight: 600;">75分</span>
                                        </div>
                                        <div class="score-track">
                                            <div class="score-fill" style="width: 75%"></div>
                                        </div>
                                    </div>
                                </div>

                                <h4>阶段性结论</h4>
                                <div class="highlight-box" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <strong style="color: white; font-size: 18px;">🎯 核心结论：高潜力，需快速验证</strong>
                                    <p style="margin-top: 12px; margin-bottom: 12px; opacity: 0.95;">
                                        你的创意"<strong>${state.userData.initialIdea || '创意验证工具'}</strong>"具有明确的商业价值和技术可行性，目标用户痛点真实，解决方案思路清晰。<strong>建议立即启动MVP验证</strong>，重点测试用户的实际参与度和付费意愿。
                                    </p>
                                    <p style="margin-bottom: 0; opacity: 0.95;">
                                        <strong>核心风险：</strong>市场教育成本和竞争壁垒不足。<strong>应对策略：</strong>快速迭代+社区运营+差异化定位。<strong>时间窗口：</strong>6-12个月，需抓紧行动。
                                    </p>
                                </div>

                                <h4>结构化行动路线图</h4>
                                <p style="margin-bottom: 16px; font-weight: 600;">接下来7天的具体行动清单：</p>

                                <div class="document-chapter" style="border: none; padding: 0; margin: 0;">
                                    <div class="chapter-header" style="background: var(--bg-secondary); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                        <div class="chapter-number" style="background: #10b981;">1</div>
                                        <div>
                                            <div class="chapter-title" style="font-size: 16px;">第1-2天：核心假设验证</div>
                                            <p style="font-size: 14px; color: var(--text-secondary); margin: 4px 0 0 0;">目标：确认问题真实存在且用户愿意付费</p>
                                        </div>
                                    </div>
                                    <ul style="margin-left: 48px; margin-bottom: 24px;">
                                        <li>在相关社区（如V2EX、知乎、即刻）发布问卷或讨论帖，收集100+份反馈</li>
                                        <li>深度访谈3-5位目标用户，用"5 Whys"挖掘真实需求</li>
                                        <li>设计一个"付费意愿测试"：描述产品并询问"如果定价$9.9/月，你会购买吗？"</li>
                                        <li><strong>成功指标：</strong>至少50%的受访者表示"有这个问题"，至少20%表示"愿意付费"</li>
                                    </ul>

                                    <div class="chapter-header" style="background: var(--bg-secondary); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                        <div class="chapter-number" style="background: #3b82f6;">2</div>
                                        <div>
                                            <div class="chapter-title" style="font-size: 16px;">第3-4天：快速原型设计</div>
                                            <p style="font-size: 14px; color: var(--text-secondary); margin: 4px 0 0 0;">目标：用最小成本呈现核心价值</p>
                                        </div>
                                    </div>
                                    <ul style="margin-left: 48px; margin-bottom: 24px;">
                                        <li>使用Figma设计核心对话流程的交互原型（5个问题+报告预览）</li>
                                        <li>或者用Notion+Typeform搭建一个"手动版"MVP，人工模拟AI对话</li>
                                        <li>准备1-2个"示例报告"，让用户直观感受最终产出</li>
                                        <li><strong>成功指标：</strong>原型可在5分钟内向陌生人讲清楚产品价值</li>
                                    </ul>

                                    <div class="chapter-header" style="background: var(--bg-secondary); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                        <div class="chapter-number" style="background: #f59e0b;">3</div>
                                        <div>
                                            <div class="chapter-title" style="font-size: 16px;">第5-6天：Landing Page + 预热</div>
                                            <p style="font-size: 14px; color: var(--text-secondary); margin: 4px 0 0 0;">目标：测试市场关注度和转化路径</p>
                                        </div>
                                    </div>
                                    <ul style="margin-left: 48px; margin-bottom: 24px;">
                                        <li>用Carrd/Webflow快速搭建一个落地页，清晰描述问题、方案、价值</li>
                                        <li>设置"加入候补名单"或"预约内测"的CTA按钮</li>
                                        <li>在Product Hunt、Indie Hackers等社区发布预告帖</li>
                                        <li><strong>成功指标：</strong>获得50+个有效邮箱注册，页面跳出率<70%</li>
                                    </ul>

                                    <div class="chapter-header" style="background: var(--bg-secondary); padding: 16px; border-radius: 12px; margin-bottom: 12px;">
                                        <div class="chapter-number" style="background: #8b5cf6;">4</div>
                                        <div>
                                            <div class="chapter-title" style="font-size: 16px;">第7天：复盘与决策</div>
                                            <p style="font-size: 14px; color: var(--text-secondary); margin: 4px 0 0 0;">目标：基于数据决定是否继续投入</p>
                                        </div>
                                    </div>
                                    <ul style="margin-left: 48px; margin-bottom: 24px;">
                                        <li>整理前6天的所有数据：用户反馈、转化率、竞品信息</li>
                                        <li>回答关键问题：<ul style="margin-top: 8px;">
                                            <li>问题是否足够痛？（用户原话是否充满frustration）</li>
                                            <li>解决方案是否被认可？（用户是否主动询问"何时可用"）</li>
                                            <li>付费意愿是否真实？（是否有人愿意预付费）</li>
                                        </ul></li>
                                        <li><strong>决策点：</strong>如果3个问题都是"是"，立即启动开发；如果有2个"否"，考虑调整方向或暂停</li>
                                    </ul>
                                </div>

                                <h4>关键里程碑与退出机制</h4>
                                <div class="highlight-box">
                                    <strong>未来3个月的关键节点</strong>
                                    <ul style="margin-top: 12px; margin-bottom: 0;">
                                        <li><strong>第1个月：</strong>完成MVP开发，获得100位内测用户，对话完成率>60% → 如果未达标，重新设计对话流程</li>
                                        <li><strong>第2个月：</strong>上线付费功能，实现首批10位付费用户，MRR达$100 → 如果未达标，调整定价或增加功能</li>
                                        <li><strong>第3个月：</strong>活跃用户达500+，付费转化率>5%，MRR达$500 → 如果未达标，考虑Pivot或暂停</li>
                                    </ul>
                                </div>

                                <h4>最后的建议</h4>
                                <div style="background: var(--bg-secondary); padding: 20px; border-radius: 12px; border-left: 4px solid var(--primary);">
                                    <p style="font-size: 15px; line-height: 1.8; margin: 0;">
                                        <strong>核心原则：快速验证，小步快跑。</strong>不要等到"产品完美"才推出，先用最简陋的方式验证核心假设。记住：<strong>用户愿意为解决方案付费的唯一证据，就是他们真的付了钱。</strong>其他一切（好评、点赞、口头承诺）都是虚荣指标。
                                    </p>
                                    <p style="font-size: 15px; line-height: 1.8; margin: 16px 0 0 0;">
                                        祝你的创意之旅顺利！如果在执行过程中遇到问题，随时回来与我对话，我会持续为你提供支持。🚀
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 商业计划书内容 -->
                <div id="business-plan" class="report-tab-content">
                    <div class="report-section">
                        <div class="report-section-title">📘 商业计划书</div>

                        <!-- 第1章：执行摘要 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">1</div>
                                <div class="chapter-title">执行摘要</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：用1-2页篇幅提供整个计划书的"缩略图"，吸引投资者继续阅读。</p>

                                <h4>价值主张</h4>
                                <p><strong>${state.userData.initialIdea || '创意验证工具'}</strong>——为${state.userData.targetUser || '目标用户群'}提供专业的解决方案，解决${state.userData.problem || '核心痛点问题'}。</p>

                                <h4>市场机会（体现"看市场/看客户"）</h4>
                                <div class="highlight-box">
                                    <strong>市场规模与增速</strong>
                                    目标市场总规模超过500万用户，年增长率30%+，用户付费意愿强烈。${state.userData.problem || '痛点'}紧迫且真实，市场需求明确。
                                </div>

                                <h4>解决方案与优势（"定控制点"）</h4>
                                <ul>
                                    <li><strong>核心方案：</strong>${state.userData.solution || '创新解决方案'}，建立差异化优势</li>
                                    <li><strong>技术壁垒：</strong>AI技术 + 专业方法论（五看三定、SWOT）双重护城河</li>
                                    <li><strong>用户体验：</strong>对话式引导，3秒开始使用，大幅降低门槛</li>
                                </ul>

                                <h4>商业模式亮点</h4>
                                <p>采用订阅制（SaaS）：免费版获客 + 专业版$9.9/月 + 企业版$29.9/月，预计6个月达收支平衡，12个月MRR达$10K+。</p>

                                <h4>梦之队（"看自己"优势）</h4>
                                <p>创始团队具备产品、技术、运营的互补能力，对${state.userData.targetUser || '目标用户'}需求有深刻洞察，执行力强。</p>

                                <h4>财务概要与融资需求</h4>
                                <ul>
                                    <li><strong>融资金额：</strong>50-100万美元种子轮，出让10-15%股权</li>
                                    <li><strong>资金用途：</strong>产品开发40% + 市场推广40% + 运营费用20%</li>
                                    <li><strong>验证指标：</strong>${state.userData.validation || '对话完成率>60%，付费转化率>5%'}</li>
                                </ul>
                            </div>
                        </div>

                        <!-- 第2章：公司概述 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">2</div>
                                <div class="chapter-title">公司概述</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：确立公司的合法性与宏大愿景，建立第一印象。</p>

                                <h4>使命、愿景与价值观</h4>
                                <p><strong>使命：</strong>通过AI技术赋能${state.userData.targetUser || '目标用户'}，让每个人都能像专业顾问一样思考问题。</p>
                                <p><strong>愿景：</strong>成为${state.userData.targetUser || '该领域'}首选的智能分析工具，服务100万+用户，建立行业标杆。</p>
                                <p><strong>核心价值观：</strong>用户至上、专业严谨、持续创新、高效执行。</p>

                                <h4>法律与股权结构</h4>
                                <div class="data-row">
                                    <span class="data-label">公司名称</span>
                                    <span class="data-value">ThinkCraft科技有限公司</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">注册地</span>
                                    <span class="data-value">中国（拟设立）</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">公司类型</span>
                                    <span class="data-value">有限责任公司</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">股权结构</span>
                                    <span class="data-value">创始团队85% + 期权池15%</span>
                                </div>

                                <h4>发展历程与现状</h4>
                                <ul>
                                    <li><strong>当前阶段：</strong>概念验证期，已完成原型开发和用户访谈</li>
                                    <li><strong>关键里程碑：</strong>产品立项、用户调研完成、寻求种子轮融资</li>
                                </ul>

                                <h4>长期战略目标（"定目标"定性描述）</h4>
                                <p>未来3-5年，成为垂直场景AI分析工具的领导者，覆盖${state.userData.targetUser || '多个用户群体'}，建立强大的品牌影响力和数据护城河。</p>
                            </div>
                        </div>

                        <!-- 第3章：市场分析 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">3</div>
                                <div class="chapter-title">市场分析（"五看"集中体现）</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：用数据和逻辑证明市场机会真实且足够大，这是投资的根本前提。</p>

                                <h4>看行业：行业与趋势分析</h4>
                                <p><strong>宏观趋势（PEST分析）：</strong></p>
                                <ul>
                                    <li><strong>政策：</strong>国家鼓励AI应用创新，支持科技创业</li>
                                    <li><strong>经济：</strong>知识经济崛起，企业对效率工具投入增加</li>
                                    <li><strong>社会：</strong>用户对AI工具接受度提升，付费习惯形成</li>
                                    <li><strong>技术：</strong>大模型技术成熟，API成本下降，应用门槛降低</li>
                                </ul>
                                <p><strong>行业增速：</strong>AI应用市场年增长率超过40%，垂直场景工具获资本青睐。</p>

                                <h4>看市场/看客户：目标市场与客户</h4>
                                <div class="highlight-box">
                                    <strong>市场规模量化</strong>
                                    • <strong>TAM（总潜在市场）：</strong>全球约500万目标用户<br>
                                    • <strong>SAM（可服务市场）：</strong>中国市场约50万用户<br>
                                    • <strong>SOM（可获得市场）：</strong>首年目标2万活跃用户（占SAM的4%）<br>
                                    • <strong>市场增长趋势：</strong>年增长率30%+，市场潜力巨大
                                </div>

                                <h4>目标客户画像</h4>
                                <p><strong>主要用户群：</strong>${state.userData.targetUser || '独立开发者、创业者、产品经理'}</p>
                                <ul>
                                    <li><strong>人口统计：</strong>年龄25-40岁，本科及以上学历，一线及新一线城市</li>
                                    <li><strong>行为特征：</strong>重视效率，活跃于技术社区，愿意为工具付费</li>
                                    <li><strong>核心痛点：</strong>${state.userData.problem || '缺乏结构化分析框架，难以快速验证想法'}</li>
                                    <li><strong>需求强度：</strong>高频需求（每周1-3次），刚需程度中等偏高</li>
                                </ul>

                                <h4>看竞争：竞争格局分析</h4>
                                <p><strong>主要竞品对比（SWOT对比）：</strong></p>
                                <div class="data-row">
                                    <span class="data-label">Notion AI</span>
                                    <span class="data-value">通用工具，缺少针对性引导和专业方法论</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Miro</span>
                                    <span class="data-value">协作工具为主，学习成本高，缺少AI智能</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">传统咨询工具</span>
                                    <span class="data-value">价格昂贵($1000+/年)，使用复杂，不适合个人</span>
                                </div>

                                <h4>市场空白与机会</h4>
                                <div class="highlight-box">
                                    <strong>未满足的需求</strong>
                                    市场缺少"专业+易用+AI驱动"的垂直分析工具，我们的${state.userData.solution || '解决方案'}精准填补这一空白。
                                </div>
                            </div>
                        </div>
        
                        <!-- 第4章：产品/服务描述 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">4</div>
                                <div class="chapter-title">产品/服务描述</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：具体阐述你如何解决问题，并证明你的解决方案具有壁垒。</p>

                                <h4>解决方案详解</h4>
                                <p><strong>产品定义：</strong>${state.userData.initialIdea || '我们的产品'}是一款面向${state.userData.targetUser || '目标用户'}的智能分析工具。</p>
                                <p><strong>如何运作：</strong>通过${state.userData.solution || 'AI对话式引导+专业方法论'}，用户只需回答5个核心问题，系统即可自动生成包含五看三定、SWOT等框架的专业分析报告。</p>
                                <p><strong>解决的痛点：</strong>彻底解决${state.userData.problem || '用户缺乏结构化分析框架的问题'}，让非专业人士也能做出专业分析。</p>

                                <h4>核心功能与特性</h4>
                                <ul>
                                    <li><strong>对话式引导：</strong>采用苏格拉底式提问，逐步挖掘用户深层思考，3秒开始使用</li>
                                    <li><strong>智能分析引擎：</strong>基于五看三定、SWOT等成熟商业方法论，自动生成专业报告</li>
                                    <li><strong>双文档输出：</strong>同时生成商业计划书（面向投资人）和产品立项材料（面向内部决策）</li>
                                    <li><strong>可视化呈现：</strong>复杂数据转化为直观图表和卡片</li>
                                    <li><strong>一键分享：</strong>生成精美分享卡片，支持社交传播，形成病毒效应</li>
                                </ul>

                                <h4>核心优势与差异化（"定控制点"具体化）</h4>
                                <div class="highlight-box">
                                    <strong>三重竞争壁垒</strong>
                                    <ul style="margin-bottom: 0;">
                                        <li><strong>技术壁垒：</strong>AI模型调优 + Prompt工程，确保输出质量</li>
                                        <li><strong>方法论壁垒：</strong>五看三定、SWOT等框架深度集成，竞品难以复制</li>
                                        <li><strong>数据壁垒：</strong>用户对话数据积累，持续优化模型效果</li>
                                    </ul>
                                </div>

                                <h4>知识产权</h4>
                                <ul>
                                    <li><strong>已申请：</strong>软件著作权、核心算法专利申请中</li>
                                    <li><strong>商标：</strong>"ThinkCraft"商标注册中</li>
                                </ul>

                                <h4>研发状态与路线图</h4>
                                <p><strong>当前状态：</strong>MVP已完成，正在进行用户内测，核心功能验证通过。</p>
                                <p><strong>未来路线图：</strong></p>
                                <ul>
                                    <li><strong>V2.0（3个月内）：</strong>付费订阅、PDF导出、高级分析功能</li>
                                    <li><strong>V3.0（6个月内）：</strong>团队协作、行业模板库、API开放</li>
                                    <li><strong>V4.0（12个月内）：</strong>多语言支持、企业定制、数据分析Dashboard</li>
                                </ul>
                            </div>
                        </div>

                        <!-- 第5章：商业模式 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">5</div>
                                <div class="chapter-title">商业模式</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：清晰展示企业如何创造、传递并获取价值，即如何赚钱。</p>

                                <h4>价值主张</h4>
                                <p>为${state.userData.targetUser || '目标用户'}提供"专业+易用+高效"的智能分析工具，让每个人都能像咨询顾问一样思考问题，以1/10的成本获得专业级分析能力。</p>

                                <h4>收入模式</h4>
                                <div class="highlight-box">
                                    <strong>三层定价策略（SaaS订阅制）</strong>
                                    <ul style="margin-bottom: 0;">
                                        <li><strong>免费版：</strong>每月3次分析机会，基础功能，用于获客和口碑传播</li>
                                        <li><strong>专业版（$9.9/月）：</strong>无限次分析 + PDF导出 + 高级功能，目标转化率5-10%</li>
                                        <li><strong>企业版（$29.9/月）：</strong>团队协作 + 定制报告 + 优先支持 + API接入</li>
                                    </ul>
                                </div>

                                <h4>成本结构</h4>
                                <ul>
                                    <li><strong>AI模型成本：</strong>使用第三方API，按量计费，约$0.02-0.05/次对话</li>
                                    <li><strong>研发成本：</strong>2-3人小团队，月成本约3-5万元（人力为主）</li>
                                    <li><strong>运营成本：</strong>云服务器$500/月 + 推广费用1-2万元/月</li>
                                    <li><strong>总月成本：</strong>约5-8万元人民币（早期阶段）</li>
                                </ul>

                                <h4>客户获取与留存路径</h4>
                                <p><strong>转化漏斗：</strong></p>
                                <ol>
                                    <li><strong>认知（Awareness）：</strong>通过内容营销、社区运营触达用户</li>
                                    <li><strong>兴趣（Interest）：</strong>免费版快速体验，感受产品价值</li>
                                    <li><strong>决策（Decision）：</strong>提供7天免费试用Pro版，降低决策门槛</li>
                                    <li><strong>行动（Action）：</strong>一键订阅，支持月付/年付</li>
                                    <li><strong>留存（Retention）：</strong>持续提供价值，定期推送新功能和分析技巧</li>
                                </ol>

                                <h4>核心资源与关键业务</h4>
                                <p><strong>核心资源：</strong>AI技术团队、专业方法论知识库、用户对话数据、品牌口碑</p>
                                <p><strong>关键业务：</strong>产品研发与迭代、AI模型优化、用户增长与运营、客户成功服务</p>

                                <div class="highlight-box">
                                    <strong>盈利预测</strong>
                                    预计6个月达收支平衡，12个月MRR达$10K+（500付费用户×$20平均客单价），付费转化率目标5-10%。
                                </div>
                            </div>
                        </div>
        
                        <!-- 第6章：营销与销售策略 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">6</div>
                                <div class="chapter-title">营销与销售策略（"定策略"在业务层面的展开）</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：展示如何有效触达并获取客户，实现增长。</p>

                                <h4>市场进入策略</h4>
                                <p><strong>初期聚焦：</strong>优先针对${state.userData.targetUser || '独立开发者、创业者'}群体，通过技术社区实现冷启动。</p>
                                <p><strong>地理重点：</strong>中国一线及新一线城市，后续扩展至全球中文市场。</p>

                                <h4>品牌与定位策略</h4>
                                <p><strong>品牌定位：</strong>"专业人士的思维助手"——既专业又易用的AI分析工具</p>
                                <p><strong>品牌调性：</strong>专业、高效、创新、可信赖</p>
                                <p><strong>品牌slogan：</strong>"将灵感转化为洞察"</p>

                                <h4>推广渠道与活动（含预算分配）</h4>
                                <div class="highlight-box">
                                    <strong>四大增长引擎</strong>
                                    <ul style="margin-bottom: 0;">
                                        <li><strong>社交传播（30%预算）：</strong>设计高质量分享卡片，利用用户炫耀心理实现病毒传播</li>
                                        <li><strong>社区运营（30%预算）：</strong>Product Hunt、V2EX、知乎、掘金等平台冷启动</li>
                                        <li><strong>内容营销（25%预算）：</strong>输出专业方法论文章，建立行业影响力和SEO</li>
                                        <li><strong>KOL合作（15%预算）：</strong>与创业/产品领域意见领袖合作推广</li>
                                    </ul>
                                </div>

                                <h4>销售渠道与流程</h4>
                                <ul>
                                    <li><strong>线上自助订阅（主要）：</strong>用户可直接在产品内完成付费订阅，无需销售介入</li>
                                    <li><strong>企业直销（补充）：</strong>针对企业版客户，提供专属销售支持和定制化方案</li>
                                    <li><strong>渠道合作（远期）：</strong>与企业服务平台（如钉钉、飞书）建立分销合作</li>
                                </ul>

                                <h4>转化策略</h4>
                                <p><strong>核心策略：</strong>先体验后付费，通过免费版建立信任，在用户感受到价值后自然转化为付费用户。</p>
                                <ul>
                                    <li>提供7天Pro版免费试用，无需信用卡</li>
                                    <li>首月订阅享5折优惠，降低决策门槛</li>
                                    <li>7天无理由退款，消除顾虑</li>
                                    <li>年付享8折优惠，提升LTV</li>
                                </ul>
                            </div>
                        </div>

                        <!-- 第7章：团队介绍 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">7</div>
                                <div class="chapter-title">团队介绍（"看自己"核心，SWOT优势关键）</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：证明团队是项目成功的最重要保障。</p>

                                <h4>创始人与核心成员</h4>
                                <p><strong>创始人/CEO：</strong>具有产品和技术复合背景，曾在头部互联网公司担任产品经理3年，主导过千万级用户产品的从0到1，对${state.userData.targetUser || '目标用户'}需求有深刻洞察。</p>
                                <p><strong>技术负责人/CTO：</strong>资深全栈工程师，5年AI应用开发经验，曾在AI创业公司担任技术架构师，擅长快速开发与系统优化。</p>
                                <p><strong>运营负责人/CGO：</strong>增长黑客专家，4年SaaS产品增长经验，擅长社交传播、社区运营和数据驱动增长，曾帮助产品实现0-10万用户突破。</p>

                                <div class="highlight-box">
                                    <strong>团队核心优势</strong>
                                    <ul style="margin-bottom: 0;">
                                        <li><strong>深刻的用户理解：</strong>创始团队本身就是${state.userData.targetUser || '目标用户'}，对痛点感同身受</li>
                                        <li><strong>能力互补的铁三角：</strong>产品+技术+运营完美配合，减少内耗</li>
                                        <li><strong>快速迭代能力：</strong>精益团队，决策链短，执行力强，2周可完成MVP</li>
                                        <li><strong>行业资源与背书：</strong>核心团队拥有丰富的行业人脉和资源</li>
                                    </ul>
                                </div>

                                <h4>顾问团队</h4>
                                <ul>
                                    <li><strong>商业顾问：</strong>知名创投机构合伙人，提供战略指导和投资人资源</li>
                                    <li><strong>技术顾问：</strong>AI领域资深专家，提供技术方向建议</li>
                                    <li><strong>行业顾问：</strong>咨询公司前合伙人，提供方法论指导</li>
                                </ul>

                                <h4>人才缺口与招聘计划</h4>
                                <p><strong>当前缺口：</strong></p>
                                <ul>
                                    <li><strong>产品设计师（优先级高）：</strong>负责UI/UX设计，提升产品体验</li>
                                    <li><strong>后端工程师（优先级中）：</strong>随用户增长需补强后端能力</li>
                                    <li><strong>客户成功经理（优先级中）：</strong>服务付费用户，提升留存率</li>
                                </ul>
                                <p><strong>招聘计划：</strong>融资到位后3个月内完成核心岗位招聘，团队扩充至6-8人。</p>
                            </div>
                        </div>
        
                        <!-- 第8章：运营计划 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">8</div>
                                <div class="chapter-title">运营计划</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：描述如何将产品/服务交付给客户，证明执行可行性。</p>

                                <h4>生产/服务交付流程</h4>
                                <p>作为SaaS产品，我们的服务交付流程简洁高效：</p>
                                <ol>
                                    <li><strong>用户注册：</strong>邮箱注册或第三方登录，30秒完成</li>
                                    <li><strong>对话分析：</strong>AI引导用户回答5个问题，平均耗时5-8分钟</li>
                                    <li><strong>报告生成：</strong>系统自动生成专业分析报告，10-15秒完成</li>
                                    <li><strong>结果交付：</strong>用户可在线查看、下载PDF、生成分享卡片</li>
                                </ol>

                                <h4>供应链与合作伙伴</h4>
                                <ul>
                                    <li><strong>AI模型供应商：</strong>OpenAI、Anthropic等，保证API稳定性和成本优化</li>
                                    <li><strong>云服务商：</strong>阿里云或AWS，确保服务高可用</li>
                                    <li><strong>支付服务：</strong>Stripe（国际）、微信/支付宝（国内）</li>
                                </ul>

                                <h4>技术与基础设施</h4>
                                <p><strong>技术栈：</strong>前端React + 后端Node.js + 数据库PostgreSQL + AI模型API</p>
                                <p><strong>基础设施：</strong>云服务器（弹性扩展） + CDN加速 + 负载均衡</p>

                                <h4>产品开发与运营里程碑</h4>
                                <div class="data-row">
                                    <span class="data-label">第1-2周</span>
                                    <span class="data-value">MVP开发，核心对话流程 + 报告生成</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">第3-4周</span>
                                    <span class="data-value">内测优化，收集反馈并快速迭代</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">第5-6周</span>
                                    <span class="data-value">公测上线，开始推广</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">第2-3月</span>
                                    <span class="data-value">功能完善，推出付费订阅</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">第6月</span>
                                    <span class="data-value">5000活跃用户，达收支平衡</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">第12月</span>
                                    <span class="data-value">2万活跃用户，MRR $10K+</span>
                                </div>
                            </div>
                        </div>

                        <!-- 第9章：财务规划 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">9</div>
                                <div class="chapter-title">财务规划（"定目标"量化核心）</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：将故事量化为财务模型，展示盈利潜力和资金需求。</p>

                                <h4>核心假设</h4>
                                <ul>
                                    <li><strong>用户增长率：</strong>月增长30-50%（早期阶段）</li>
                                    <li><strong>免费转付费率：</strong>5-10%（行业平均水平）</li>
                                    <li><strong>平均客单价：</strong>$15/月（专业版+企业版加权平均）</li>
                                    <li><strong>用户留存率：</strong>月留存70%+（SaaS标准）</li>
                                    <li><strong>AI成本：</strong>$0.03/次对话（持续优化）</li>
                                </ul>

                                <h4>3年财务预测摘要</h4>
                                <div class="highlight-box">
                                    <strong>年度收入预测</strong>
                                    <ul style="margin-bottom: 0;">
                                        <li><strong>第1年：</strong>MRR从$0增长至$10-12K，年营收约$60-80K</li>
                                        <li><strong>第2年：</strong>MRR达$50-80K，年营收约$600-900K</li>
                                        <li><strong>第3年：</strong>MRR达$150-200K，年营收约$1.8-2.4M</li>
                                    </ul>
                                </div>

                                <h4>关键绩效指标（KPIs）</h4>
                                <ul>
                                    <li><strong>CAC（用户获取成本）：</strong>目标$10-20/用户</li>
                                    <li><strong>LTV（客户终身价值）：</strong>目标$150-300/用户</li>
                                    <li><strong>LTV/CAC比率：</strong>目标10:1以上（健康水平）</li>
                                    <li><strong>毛利率：</strong>目标80%+（SaaS典型水平）</li>
                                    <li><strong>盈亏平衡点：</strong>预计第6-9个月</li>
                                </ul>

                                <h4>资金需求与使用计划</h4>
                                <p><strong>融资金额：</strong>寻求<strong>50-100万美元</strong>种子轮融资，出让<strong>10-15%</strong>股权。</p>

                                <div class="highlight-box">
                                    <strong>资金使用规划（未来12-18个月）</strong>
                                    <ul style="margin-bottom: 0;">
                                        <li><strong>产品开发（40%）：</strong>核心功能完善、高级特性开发、性能优化</li>
                                        <li><strong>市场推广（40%）：</strong>社区运营、内容营销、KOL合作、广告投放</li>
                                        <li><strong>团队扩充（15%）：</strong>招聘设计师、工程师、客户成功经理</li>
                                        <li><strong>运营费用（5%）：</strong>服务器、办公、法务等日常开销</li>
                                    </ul>
                                </div>

                                <h4>退出机制</h4>
                                <p>预计3-5年内通过以下方式实现投资人退出：</p>
                                <ul>
                                    <li><strong>战略并购：</strong>被大型企业服务公司或AI平台收购，目标估值$50-150M</li>
                                    <li><strong>下一轮融资：</strong>A轮融资时老股东部分退出</li>
                                    <li><strong>IPO（远期）：</strong>若发展顺利，考虑纳斯达克上市</li>
                                </ul>
                            </div>
                        </div>

                        <!-- 第10章：风险分析 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">10</div>
                                <div class="chapter-title">风险分析（来源于SWOT的W和T）</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：展示创始人已全面思考过风险，并拥有应对预案，增加可信度。</p>

                                <h4>主要风险识别与应对</h4>

                                <div class="highlight-box">
                                    <strong>风险1：技术依赖风险</strong>
                                    <p><strong>风险描述：</strong>依赖第三方AI模型，成本波动和性能不可控</p>
                                    <p><strong>应对策略：</strong></p>
                                    <ul style="margin-bottom: 0;">
                                        <li>选择多个模型供应商（OpenAI + Anthropic + 国产模型），避免单点依赖</li>
                                        <li>深度优化Prompt工程，降低Token使用量30%+</li>
                                        <li>建立缓存机制，相似问题复用结果</li>
                                        <li>预留应急资金，应对短期成本上涨</li>
                                    </ul>
                                </div>

                                <div class="highlight-box">
                                    <strong>风险2：市场教育成本高</strong>
                                    <p><strong>风险描述：</strong>用户对产品价值理解不足，付费意愿低于预期</p>
                                    <p><strong>应对策略：</strong></p>
                                    <ul style="margin-bottom: 0;">
                                        <li>提供免费版，降低尝试门槛，让用户先体验价值</li>
                                        <li>设计清晰的价值演示视频和案例教程</li>
                                        <li>通过内容营销（文章、视频）建立专业形象</li>
                                        <li>监控转化漏斗，持续优化关键转化节点</li>
                                    </ul>
                                </div>

                                <div class="highlight-box">
                                    <strong>风险3：大厂竞争威胁</strong>
                                    <p><strong>风险描述：</strong>大公司推出类似功能，形成降维打击</p>
                                    <p><strong>应对策略：</strong></p>
                                    <ul style="margin-bottom: 0;">
                                        <li>专注垂直场景，建立专业方法论壁垒（五看三定、SWOT）</li>
                                        <li>快速积累用户数据，形成数据护城河</li>
                                        <li>保持快速迭代，持续创新保持领先</li>
                                        <li>建立品牌忠诚度和社区，增加用户粘性</li>
                                    </ul>
                                </div>

                                <div class="highlight-box">
                                    <strong>风险4：团队规模与资源限制</strong>
                                    <p><strong>风险描述：</strong>小团队资源有限，难以同时兼顾产品、运营、销售</p>
                                    <p><strong>应对策略：</strong></p>
                                    <ul style="margin-bottom: 0;">
                                        <li>保持精益运营，聚焦核心功能，避免过度分散</li>
                                        <li>优先级清晰，遵循"One Metric That Matters"原则</li>
                                        <li>善用外部资源（顾问、外包、实习生）</li>
                                        <li>融资后迅速补齐关键岗位短板</li>
                                    </ul>
                                </div>

                                <h4>其他风险</h4>
                                <ul>
                                    <li><strong>监管风险：</strong>AI相关监管政策可能收紧，需密切关注政策动向，确保合规</li>
                                    <li><strong>数据安全风险：</strong>用户数据泄露，建立严格的数据安全机制和隐私政策</li>
                                    <li><strong>现金流风险：</strong>早期烧钱阶段现金流紧张，需合理控制支出，预留6个月运营资金</li>
                                </ul>
                            </div>
                        </div>

                        <!-- 第11章：附录 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">11</div>
                                <div class="chapter-title">附录</div>
                            </div>
                            <div class="chapter-content">
                                <p style="color: var(--text-tertiary); font-style: italic; margin-bottom: 16px;">核心目的：为正文中的关键论断提供详细证据，避免正文冗长。</p>

                                <h4>附录材料清单</h4>
                                <ul>
                                    <li><strong>详细市场调研数据：</strong>包含用户访谈记录、问卷调查结果、市场规模测算依据</li>
                                    <li><strong>产品设计图/原型：</strong>完整的产品线框图、交互流程图、UI设计稿</li>
                                    <li><strong>专利证书/知识产权：</strong>软件著作权证书、专利申请文件</li>
                                    <li><strong>团队成员完整简历：</strong>核心团队成员的教育背景、工作经历、项目成果</li>
                                    <li><strong>重要合作协议：</strong>与AI模型供应商、云服务商的合作协议（脱敏版）</li>
                                    <li><strong>详细财务模型：</strong>Excel财务预测表，包含所有假设和计算公式</li>
                                    <li><strong>用户测试反馈：</strong>Beta版用户的使用反馈和满意度调查</li>
                                    <li><strong>技术架构文档：</strong>系统架构图、数据库设计、API文档</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
        
                <!-- 产品立项材料内容 -->
                <div id="product-plan" class="report-tab-content">
                    <div class="report-section">
                        <div class="report-section-title">📝 产品立项材料</div>

                        <!-- 第1章：项目背景与机会 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">1</div>
                                <div class="chapter-title">项目背景与机会</div>
                            </div>
                            <div class="chapter-content">
                                <h4>项目背景</h4>
                                <p>当前${state.userData.targetUser || '目标用户群'}面临着${state.userData.problem || '明显的痛点问题'}，市场上缺乏有效的解决方案。</p>
        
                                <div class="highlight-box">
                                    <strong>市场机会（五看分析）</strong>
                                    • <strong>行业趋势：</strong>AI应用从通用向垂直场景深化<br>
                                    • <strong>市场规模：</strong>目标市场500万+用户，持续增长<br>
                                    • <strong>客户需求：</strong>${state.userData.problem || '用户痛点明确，需求强烈'}<br>
                                    • <strong>竞争格局：</strong>现有方案存在明显不足，窗口期明确<br>
                                    • <strong>自身优势：</strong>${state.userData.solution || '创新解决方案'}建立差异化
                                </div>
        
                                <h4>立项必要性</h4>
                                <ul>
                                    <li>用户需求真实且强烈，市场验证清晰</li>
                                    <li>技术成熟度高，开发风险可控</li>
                                    <li>竞争窗口期有限，需要快速行动</li>
                                    <li>符合公司战略方向，资源投入合理</li>
                                </ul>
                            </div>
                        </div>
        
                        <!-- 第2章：产品定义 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">2</div>
                                <div class="chapter-title">产品定义</div>
                            </div>
                            <div class="chapter-content">
                                <h4>产品概述</h4>
                                <p><strong>产品名称：</strong>${state.userData.initialIdea || 'ThinkCraft AI思维助手'}</p>
                                <p><strong>产品定位：</strong>面向${state.userData.targetUser || '目标用户'}的智能分析工具</p>
                                <p><strong>核心价值：</strong>通过${state.userData.solution || 'AI技术和专业方法论'}，帮助用户快速完成专业分析</p>
        
                                <h4>核心功能</h4>
                                <ul>
                                    <li><strong>对话式引导：</strong>苏格拉底式提问，逐步引导用户深度思考</li>
                                    <li><strong>智能分析：</strong>基于五看三定、SWOT等框架自动生成报告</li>
                                    <li><strong>结果可视化：</strong>将复杂分析转化为易懂的图表和卡片</li>
                                    <li><strong>分享传播：</strong>一键生成精美分享卡片</li>
                                </ul>
        
                                <h4>差异化优势（定控制点）</h4>
                                <div class="highlight-box">
                                    <strong>三重壁垒</strong>
                                    • <strong>对话式引导：</strong>降低使用门槛，3秒开始使用<br>
                                    • <strong>专业方法论：</strong>五看三定、SWOT等框架难以复制<br>
                                    • <strong>数据积累：</strong>用户对话数据形成训练素材
                                </div>
                            </div>
                        </div>
        
                        <!-- 第3章：目标用户与场景 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">3</div>
                                <div class="chapter-title">目标用户与场景</div>
                            </div>
                            <div class="chapter-content">
                                <h4>用户画像（看客户）</h4>
                                <p><strong>主要用户群：</strong>${state.userData.targetUser || '独立开发者、创业者、产品经理'}</p>
                                <p><strong>年龄段：</strong>25-40岁</p>
                                <p><strong>职业特征：</strong>知识工作者，对效率工具敏感，具备付费能力</p>
                                <p><strong>核心痛点：</strong>${state.userData.problem || '缺乏结构化的分析方法，难以做出正确决策'}</p>
        
                                <h4>典型使用场景</h4>
                                <ul>
                                    <li><strong>场景1：</strong>创业者验证新项目的商业可行性</li>
                                    <li><strong>场景2：</strong>产品经理评估新功能的优先级</li>
                                    <li><strong>场景3：</strong>独立开发者分析项目的市场机会</li>
                                    <li><strong>场景4：</strong>学生或求职者规划职业发展路径</li>
                                </ul>
        
                                <h4>用户旅程</h4>
                                <p><strong>触达 → 注册 → 首次对话 → 查看报告 → 分享 → 复购</strong></p>
                                <p>关键节点：首次对话完成率>60%，分享率>20%，7日留存率>40%</p>
                            </div>
                        </div>
        
                        <!-- 第4章：市场与竞争分析 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">4</div>
                                <div class="chapter-title">市场与竞争分析（看竞争）</div>
                            </div>
                            <div class="chapter-content">
                                <h4>市场规模</h4>
                                <p><strong>全球市场：</strong>约500万目标用户</p>
                                <p><strong>中国市场：</strong>约50万目标用户</p>
                                <p><strong>增长趋势：</strong>年增长率30%+，市场潜力巨大</p>
        
                                <h4>竞品分析</h4>
                                <div class="data-row">
                                    <span class="data-label">Notion AI</span>
                                    <span class="data-value">通用工具，缺少针对性引导</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">Miro</span>
                                    <span class="data-value">协作工具，学习成本高</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">传统咨询工具</span>
                                    <span class="data-value">价格昂贵，使用复杂</span>
                                </div>
        
                                <h4>竞争优势</h4>
                                <ul>
                                    <li><strong>专注垂直场景：</strong>避免与通用工具正面竞争</li>
                                    <li><strong>降低使用门槛：</strong>对话式交互，3秒开始使用</li>
                                    <li><strong>专业方法论加持：</strong>输出结果更具权威性</li>
                                    <li><strong>性价比优势：</strong>价格仅为传统咨询工具的1/10</li>
                                </ul>
                            </div>
                        </div>
        
                        <!-- 第5章：可行性分析（核心章节，SWOT重点） -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">5</div>
                                <div class="chapter-title">可行性分析（SWOT核心应用）</div>
                            </div>
                            <div class="chapter-content">
                                <h4>技术可行性</h4>
                                <p><strong>✅ 可行</strong> - 基于成熟的AI大模型API，技术实现难度低，开发周期短（2-4周即可完成MVP）。</p>
        
                                <h4>商业可行性</h4>
                                <p><strong>✅ 可行</strong> - 用户付费意愿强，市场需求明确，盈利模式清晰（订阅制），预计6个月可达收支平衡。</p>
        
                                <h4>资源可行性</h4>
                                <p><strong>✅ 可行</strong> - 所需团队规模小（2-3人），资金需求适中（50-100万美元），风险可控。</p>
        
                                <h4>SWOT综合分析</h4>
                                <div class="analysis-grid" style="margin-top: 20px;">
                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon">💪</div>
                                            <div class="analysis-card-title">优势 (Strengths)</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>聚焦${state.userData.targetUser || '目标用户'}垂直场景，专业度高</li>
                                                <li>采用${state.userData.solution || '创新方案'}，差异化明显</li>
                                                <li>AI技术加持，可快速迭代优化</li>
                                                <li>团队对用户需求理解深刻</li>
                                            </ul>
                                        </div>
                                    </div>
        
                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon">⚠️</div>
                                            <div class="analysis-card-title">劣势 (Weaknesses)</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>品牌知名度低，需要教育市场</li>
                                                <li>资源有限，研发和推广需要权衡</li>
                                                <li>依赖AI模型，成本和性能受第三方影响</li>
                                                <li>初期用户数据少，模型优化空间有限</li>
                                            </ul>
                                        </div>
                                    </div>
        
                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon">🚀</div>
                                            <div class="analysis-card-title">机会 (Opportunities)</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>AI应用爆发期，用户接受度高</li>
                                                <li>垂直场景工具需求旺盛，竞争相对较小</li>
                                                <li>解决${state.userData.problem || '真实痛点'}，市场需求明确</li>
                                                <li>创投环境活跃，融资机会多</li>
                                            </ul>
                                        </div>
                                    </div>
        
                                    <div class="analysis-card">
                                        <div class="analysis-card-header">
                                            <div class="analysis-icon">⚡</div>
                                            <div class="analysis-card-title">威胁 (Threats)</div>
                                        </div>
                                        <div class="analysis-card-content">
                                            <ul style="margin: 0; padding-left: 20px;">
                                                <li>大厂可能推出类似功能，形成降维打击</li>
                                                <li>同质化竞争加剧，需持续创新保持领先</li>
                                                <li>AI技术快速变化，需不断适配新模型</li>
                                                <li>用户隐私和数据安全监管趋严</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
        
                                <div class="highlight-box" style="margin-top: 24px;">
                                    <strong>可行性结论</strong>
                                    综合SWOT分析，项目<strong>技术可行、商业可行、资源可行</strong>。建议立项启动，采用精益创业方法快速验证，重点关注用户留存和付费转化两个核心指标。
                                </div>
                            </div>
                        </div>
        
                        <!-- 第6章：产品路线图 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">6</div>
                                <div class="chapter-title">产品路线图（定策略）</div>
                            </div>
                            <div class="chapter-content">
                                <h4>MVP版本（V1.0）- 第1-2周</h4>
                                <ul>
                                    <li>核心对话流程（5个关键问题）</li>
                                    <li>基础分析报告生成</li>
                                    <li>简单分享功能</li>
                                </ul>
        
                                <h4>公测版本（V1.5）- 第3-6周</h4>
                                <ul>
                                    <li>优化对话体验，增加智能追问</li>
                                    <li>丰富报告内容，增加可视化图表</li>
                                    <li>完善分享卡片设计</li>
                                    <li>增加用户历史记录</li>
                                </ul>
        
                                <h4>正式版本（V2.0）- 第2-3月</h4>
                                <ul>
                                    <li>推出付费订阅功能</li>
                                    <li>支持PDF导出和分享链接</li>
                                    <li>增加高级分析功能</li>
                                    <li>优化AI模型使用，降低成本</li>
                                </ul>
        
                                <h4>增强版本（V3.0）- 第4-6月</h4>
                                <ul>
                                    <li>支持团队协作</li>
                                    <li>增加行业模板库</li>
                                    <li>数据分析Dashboard</li>
                                    <li>API开放能力</li>
                                </ul>
                            </div>
                        </div>
        
                        <!-- 第7章：资源需求 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">7</div>
                                <div class="chapter-title">资源需求（基于W和T的补充）</div>
                            </div>
                            <div class="chapter-content">
                                <h4>人力需求</h4>
                                <ul>
                                    <li><strong>产品经理：</strong>1名，负责产品设计和用户调研</li>
                                    <li><strong>全栈工程师：</strong>1-2名，负责前后端开发</li>
                                    <li><strong>运营人员：</strong>1名，负责市场推广和社区运营</li>
                                </ul>
        
                                <h4>技术资源</h4>
                                <ul>
                                    <li><strong>AI模型API：</strong>预算$500-1000/月</li>
                                    <li><strong>云服务器：</strong>预算$200-500/月</li>
                                    <li><strong>开发工具：</strong>预算$100/月</li>
                                </ul>
        
                                <h4>资金需求</h4>
                                <div class="data-row">
                                    <span class="data-label">种子轮融资</span>
                                    <span class="data-value">50-100万美元</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">月度运营成本</span>
                                    <span class="data-value">5-8万元人民币</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">预计收支平衡周期</span>
                                    <span class="data-value">6-9个月</span>
                                </div>
                            </div>
                        </div>
        
                        <!-- 第8章：成功标准与评估 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">8</div>
                                <div class="chapter-title">成功标准与评估（定目标）</div>
                            </div>
                            <div class="chapter-content">
                                <h4>核心KPI</h4>
                                <div class="highlight-box">
                                    <strong>用户验证指标</strong>
                                    ${state.userData.validation || '对话完成率>60%，7日留存率>40%，付费转化率>5%'}
                                </div>
        
                                <h4>阶段性目标</h4>
                                <ul>
                                    <li><strong>3个月：</strong>
                                        <ul>
                                            <li>注册用户：1000+</li>
                                            <li>活跃用户：500+</li>
                                            <li>对话完成率：>60%</li>
                                            <li>用户满意度：>4.0/5.0</li>
                                        </ul>
                                    </li>
                                    <li><strong>6个月：</strong>
                                        <ul>
                                            <li>注册用户：5000+</li>
                                            <li>活跃用户：2000+</li>
                                            <li>付费用户：100+</li>
                                            <li>MRR：$2K-5K</li>
                                        </ul>
                                    </li>
                                    <li><strong>12个月：</strong>
                                        <ul>
                                            <li>注册用户：20000+</li>
                                            <li>活跃用户：8000+</li>
                                            <li>付费用户：500+</li>
                                            <li>MRR：$10K+</li>
                                        </ul>
                                    </li>
                                </ul>
        
                                <h4>评估机制</h4>
                                <p>每月进行数据复盘，重点关注用户增长、留存率、付费转化三个核心指标。若连续2个月未达标，需调整产品策略或市场方向。</p>
                            </div>
                        </div>
        
                        <!-- 第9章：风险评估与预案 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">9</div>
                                <div class="chapter-title">风险评估与预案（来源于W和T）</div>
                            </div>
                            <div class="chapter-content">
                                <h4>主要风险及应对</h4>
        
                                <div class="highlight-box">
                                    <strong>风险1：技术依赖风险</strong>
                                    <p><strong>风险描述：</strong>依赖第三方AI模型，成本和性能不可控</p>
                                    <p><strong>应对策略：</strong>
                                    • 选择多个模型供应商，避免单点依赖<br>
                                    • 优化prompt工程，降低Token使用量<br>
                                    • 建立缓存机制，减少重复调用</p>
                                </div>
        
                                <div class="highlight-box">
                                    <strong>风险2：市场教育成本高</strong>
                                    <p><strong>风险描述：</strong>用户对产品价值理解不足，转化率低</p>
                                    <p><strong>应对策略：</strong>
                                    • 降低使用门槛，提供即时价值反馈<br>
                                    • 通过内容营销建立专业形象<br>
                                    • 设计病毒传播机制，利用用户口碑</p>
                                </div>
        
                                <div class="highlight-box">
                                    <strong>风险3：大厂竞争压力</strong>
                                    <p><strong>风险描述：</strong>大公司推出类似功能，形成降维打击</p>
                                    <p><strong>应对策略：</strong>
                                    • 专注垂直场景，建立专业壁垒<br>
                                    • 快速积累用户数据，形成数据护城河<br>
                                    • 保持快速迭代，持续创新保持领先</p>
                                </div>
        
                                <h4>止损机制</h4>
                                <p>若6个月内无法达到1000活跃用户或对话完成率低于40%，则考虑调整产品方向或暂停项目，避免资源浪费。</p>
                            </div>
                        </div>
        
                        <!-- 第10章：附录 -->
                        <div class="document-chapter">
                            <div class="chapter-header">
                                <div class="chapter-number">10</div>
                                <div class="chapter-title">附录</div>
                            </div>
                            <div class="chapter-content">
                                <h4>附录材料</h4>
                                <ul>
                                    <li><strong>用户调研报告：</strong>15位目标用户的深度访谈记录</li>
                                    <li><strong>技术原型：</strong>Figma设计稿和交互演示视频</li>
                                    <li><strong>竞品分析表：</strong>详细的竞品功能对比和定价分析</li>
                                    <li><strong>财务模型：</strong>Excel财务预测表（3年期）</li>
                                    <li><strong>技术架构图：</strong>系统架构和数据流程图</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function closeReport() {
            document.getElementById('reportModal').classList.remove('active');
        }

        // Tab 切换逻辑
        function switchReportTab(tabName) {
            // 移除所有 tab 的 active 状态
            const tabs = document.querySelectorAll('.report-tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // 移除所有 tab 内容的 active 状态
            const tabContents = document.querySelectorAll('.report-tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // 激活当前 tab
            if (tabName === 'insights') {
                tabs[0].classList.add('active');
                document.getElementById('insights-plan').classList.add('active');
            } else if (tabName === 'business') {
                tabs[1].classList.add('active');
                document.getElementById('business-plan').classList.add('active');
            } else if (tabName === 'product') {
                tabs[2].classList.add('active');
                document.getElementById('product-plan').classList.add('active');
            }
        }

        // 显示分享卡片
        function showShareCard() {
            updateShareCard();
            document.getElementById('shareModal').classList.add('active');
        }

        function updateShareCard() {
            document.getElementById('shareIdeaTitle').textContent = state.userData.initialIdea || '创意验证工具';

            const tags = [state.userData.targetUser || '创业者', '思维工具'];
            document.getElementById('shareTag1').textContent = tags[0];
            document.getElementById('shareTag2').textContent = tags[1];

            // 设置生成日期
            const today = new Date();
            const dateStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
            document.getElementById('shareDate').textContent = dateStr;
        }

        function closeShareModal() {
            document.getElementById('shareModal').classList.remove('active');
        }

        // 下载卡片为图片
        function downloadCard() {
            const card = document.getElementById('shareCard');
            html2canvas(card, {
                scale: 2,
                backgroundColor: null,
                logging: false
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'thinkcraft-' + Date.now() + '.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        // 复制分享文案
        function copyShareText() {
            const text = `我用 ThinkCraft AI 深度分析了我的想法"${state.userData.initialIdea || '新创意'}"

🎯 目标用户：${state.userData.targetUser}
💡 核心方案：${state.userData.solution}
📊 综合评分：85分

这是一份基于五看三定、SWOT等专业方法论的AI分析报告，欢迎给我提意见！

#ThinkCraft #AI思维助手 #创意验证`;

            navigator.clipboard.writeText(text).then(() => {
                alert('✅ 文案已复制到剪贴板！\n\n可以直接粘贴到微信、微博等平台分享。');
            });
        }

        // 导出完整PDF
        function exportFullReport() {
            alert('📄 PDF导出功能\n\n将生成包含所有分析内容的PDF文件，包括：\n• 五看三定分析\n• 市场机会分析\n• SWOT分析\n• AI洞察建议\n• 风险评估\n\n（此功能需要后端支持）');
        }

        // 生成分享链接
        function generateShareLink() {
            // 关闭详细分析报告弹窗
            closeReport();

            // 更新分享卡片内容
            updateShareCard();

            // 显示创意分享弹窗
            document.getElementById('shareModal').classList.add('active');
        }

        // 设置相关
        function showSettings() {
            document.getElementById('settingsModal').classList.add('active');
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        function loadSettings() {
            const saved = localStorage.getItem('thinkcraft_settings');
            if (saved) {
                state.settings = JSON.parse(saved);
            }
            document.getElementById('darkModeToggle').checked = state.settings.darkMode;
            document.getElementById('saveHistoryToggle').checked = state.settings.saveHistory;
        }

        function saveSettings() {
            localStorage.setItem('thinkcraft_settings', JSON.stringify(state.settings));
        }

        function toggleDarkMode() {
            state.settings.darkMode = document.getElementById('darkModeToggle').checked;
            saveSettings();
            alert('暗色模式功能开发中，敬请期待！');
        }

        function toggleSaveHistory() {
            state.settings.saveHistory = document.getElementById('saveHistoryToggle').checked;
            saveSettings();
        }

        function clearAllHistory() {
            if (confirm('确定要清除所有历史记录吗？此操作不可恢复。')) {
                localStorage.removeItem('thinkcraft_chats');
                state.chats = [];
                loadChats();
                alert('✅ 历史记录已清除');
            }
        }

        function handleVoice() {
            alert('🎤 语音输入\n\n正在启动语音识别...\n（需要浏览器支持 Web Speech API）');
        }

        function handleImage() {
            alert('📷 图片识别\n\n可以上传手绘草图、白板照片等，AI会自动提取文字和理解内容。\n\n（此功能需要OCR服务支持）');
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
        }

        // 点击模态框外部关闭
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>
