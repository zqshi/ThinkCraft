# DeepResearch 集成验证清单

使用此清单验证 DeepResearch 集成是否正常工作。

## ✅ 环境准备

- [ ] 已获取 OpenRouter API Key
- [ ] 已充值 OpenRouter 账户（至少 $5）
- [ ] Python 3.10+ 已安装
- [ ] Node.js 已安装
- [ ] 项目依赖已安装

## ✅ Python 微服务

### 配置

- [ ] 已创建 `.env` 文件（从 `.env.example` 复制）
- [ ] 已在 `.env` 中设置 `OPENROUTER_API_KEY`
- [ ] API Key 格式正确（以 `sk-or-v1-` 开头）

### 启动

- [ ] 虚拟环境已创建
- [ ] 依赖已安装（`pip install -r requirements.txt`）
- [ ] 服务已启动（`python app.py`）
- [ ] 服务监听在 `http://localhost:5001`

### 测试

- [ ] 健康检查通过：`curl http://localhost:5001/health`
- [ ] 返回 `{"status":"ok"}`
- [ ] 章节生成测试通过（使用 `test_service.sh`）
- [ ] 生成内容合理且完整

## ✅ Node.js 后端

### 配置

- [ ] `backend/.env` 包含 `DEEPRESEARCH_SERVICE_URL=http://localhost:5001`
- [ ] 后端依赖已安装（`npm install`）

### 启动

- [ ] 后端服务已启动（`npm start`）
- [ ] 后端监听在 `http://localhost:3000`
- [ ] 后端日志显示正常启动

### 测试

- [ ] 后端健康检查通过：`curl http://localhost:3000/health`
- [ ] 可以调用章节生成 API

## ✅ 前端集成

### UI 检查

- [ ] 章节选择弹窗显示"启用深度研究模式"开关
- [ ] 可以选择研究深度（浅层/中等/深度）
- [ ] 开关状态正确保存和恢复

### 功能测试

- [ ] 创建新对话
- [ ] 输入产品创意
- [ ] 点击"生成商业计划书"
- [ ] 勾选"启用深度研究模式"
- [ ] 选择研究深度
- [ ] 选择章节
- [ ] 点击"开始生成"
- [ ] 进度弹窗正确显示
- [ ] 章节内容成功生成
- [ ] 生成内容质量符合预期

## ✅ 降级策略

### 测试降级

- [ ] 停止 Python 微服务
- [ ] 尝试生成章节（启用深度研究）
- [ ] 系统自动重试 5 次
- [ ] 弹出降级询问对话框
- [ ] 选择"降级到 DeepSeek"
- [ ] 使用 DeepSeek 成功生成章节
- [ ] 选择"停止生成"
- [ ] 生成流程正确停止

## ✅ 成本监控

- [ ] 在 OpenRouter 控制台查看使用情况
- [ ] 单章节成本符合预期
- [ ] 账户余额充足
- [ ] 设置了成本告警（可选）

## ✅ 错误处理

### 测试错误场景

- [ ] API Key 无效 → 返回清晰错误信息
- [ ] 网络超时 → 正确重试和提示
- [ ] 余额不足 → 提示充值
- [ ] 服务不可用 → 提供降级选项

## ✅ 性能验证

### 生成时间

- [ ] 浅层模式：< 3 分钟
- [ ] 中等模式：< 6 分钟
- [ ] 深度模式：< 12 分钟

### 内容质量

- [ ] 内容专业且详细
- [ ] 逻辑清晰连贯
- [ ] 数据合理可信
- [ ] 格式规范统一

## ✅ 文档检查

- [ ] 已阅读 `QUICKSTART.md`
- [ ] 已阅读 `README.md`
- [ ] 已阅读 `docs/DEEPRESEARCH_INTEGRATION.md`
- [ ] 了解故障排查方法
- [ ] 了解成本估算

## ✅ 生产准备（可选）

- [ ] 配置 Gunicorn 或其他 WSGI 服务器
- [ ] 设置 Systemd 服务
- [ ] 配置 Nginx 反向代理
- [ ] 设置日志轮转
- [ ] 配置监控告警
- [ ] 设置自动重启
- [ ] 备份配置文件

## 📝 验证结果

### 通过标准

- 所有核心功能测试项通过（✅）
- 至少完成一次完整的端到端测试
- 降级策略正常工作
- 错误处理符合预期

### 记录问题

如果有任何测试项未通过，请记录：

1. 问题描述
2. 错误信息
3. 复现步骤
4. 尝试的解决方案

---

**验证完成后，你就可以正式使用 DeepResearch 深度研究功能了！** 🎉
