# 流程推进自检清单

> 在每阶段推进前进行最小必要合规自检，防止越级与错误产物

---

## 适用角色

- product-demand-manager-agent
- product-research-analyst-agent
- product-demand-challenge-agent
- product-demand-refine-agent
- strategy-design-agent
- strategy-design-challenge-agent

---

## 目标

保障单一流程准绳，防止越级推进和错误产物流转。

---

## 通用检查项（推进前必须全部通过）

- [ ] **上一阶段是否已获得"用户明确确认"**（未确认则不得推进）
- [ ] **本阶段使用的文档模板是否匹配**（见共享模板库）
- [ ] **文档路径与命名是否符合规范**
- [ ] **依赖文件是否存在**，且名称与目录均正确
- [ ] **是否涉及"人类决策区"**（挑战回应流程适用）；如缺失，先补齐再推进
- [ ] **是否符合核心原则**：功能为中心、可测试、结构化、无全局流程依赖

---

## 分阶段关键项

### 需求设计阶段

#### 1.1 需求收集

- [ ] 用户原始需求已完整记录
- [ ] 使用"用户需求输入-模板"

#### 1.2 需求澄清

- [ ] 使用"需求澄清问题-模板"
- [ ] 澄清问题已生成并等待用户回复

#### 1.3 需求设计（传统版输出）

- [ ] 使用"需求设计文档-传统版-模板"
- [ ] 文件名：需求设计文档-传统版-v{YYYYMMDDHHmmss}.md
- [ ] 目录：ProductManagerDoc/demand-design-doc/

#### 1.4~1.6 挑战-回应-裁决

- [ ] 回应文档包含"人类决策区"
- [ ] 裁决结果留痕
- [ ] 裁决后已回写设计文档（进入 1.7）

#### 1.12 精炼（LLM版输出）

- [ ] 输入文件为"需求设计文档-传统版.md"
- [ ] 输出为"需求设计文档-LLM版-v{YYYYMMDDHHmmss}.md"
- [ ] 二者同目录

### 战略设计阶段

#### 2.1 战略设计分析

- [ ] 使用"战略设计分析文档-模板"
- [ ] 包含候选列表的反思论述

#### 2.2 战略设计文档

- [ ] 使用"战略设计文档-模板"
- [ ] 包含版本号

#### 2.3~2.5 挑战-回应-裁决

- [ ] 回应文档包含"人类裁决"区域
- [ ] 裁决结果留痕

### 开发阶段

#### 3.1 前端开发

- [ ] 使用"前端开发文档-模板"
- [ ] 技术栈、项目结构、核心组件设计完整

#### 3.2 测试

- [ ] 测试计划、测试用例、测试报告完整
- [ ] 测试覆盖率达标

#### 3.3 部署

- [ ] 部署方案、运维手册完整
- [ ] CI/CD 流程配置完成

---

## 权威来源

### 流程准绳

- 流程规范文档（如 CLAUDE.md 或 OrchestratorAgent.md）

### 原则约束

- [产品核心原则](../../product-core-shared.md)
- 大模型原生应用核心原则（强制）
- 遵循声明与边界禁则

### 模板与清单

- [共享模板库](../_index.md)
- [文档合规自检](./document-compliance.md)

---

## 阻断机制

### 何时阻断？

- 上一阶段未获用户明确确认
- 文档不符合模板要求
- 依赖文件缺失或路径错误
- 人类决策区缺失（挑战回应流程）
- 违反核心原则

### 阻断通知模板

```
检测到以下不合规项：
1. [具体问题描述]
2. [具体问题描述]

请按照共享模板库对应模板修复后，重新提交自检结果。
在获得用户明确确认前，流程将保持阻断。
```

---

## 快速自检命令

### 阶段提交自检

```
请按流程推进自检清单完成自检，并回填：
- 模板对齐：是/否（若否，列出缺失章节）
- 命名/路径：通过/不通过（列出不通过项）
- 依赖文件：存在/缺失（列出缺失文件）
- 人类决策区：存在/缺失（如缺失先补齐）
```

---

## 常见问题

### Q1: 如何判断"用户明确确认"？

A: 用户明确表示"确认"、"同意"、"可以推进"等明确的肯定表述。模糊表述（如"看起来不错"）不算明确确认。

### Q2: 如果用户跳过某个阶段怎么办？

A: 必须向用户说明流程要求，建议不要跳过。如果用户坚持跳过，需要在文档中记录"用户要求跳过XX阶段"。

### Q3: 如果发现依赖文件路径错误怎么办？

A: 立即阻断流程，要求修正路径后重新提交。

### Q4: 人类决策区的格式有要求吗？

A: 必须包含明确的选择项（如"采纳挑战"、"采纳回应"、"自定义修改"），并预留用户填写区域。
