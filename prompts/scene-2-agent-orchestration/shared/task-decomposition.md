# 任务分解方法论

Version: 1.0.1
Last Updated: 2026-01-28

## 概述

本文档定义了Agent调度链路中的任务分解方法论，用于将复杂任务拆解为可执行的子任务。

## 核心原则

### 1. 能力驱动分解

根据可用Agent的能力进行任务分解，而不是预设的流程步骤。

**示例**：

```
原始任务：开发一个用户管理系统

能力驱动分解：
1. 需求分析（产品需求管理Agent）
2. 数据库设计（技术负责人Agent）
3. 后端API开发（后端开发Agent）
4. 前端界面开发（前端开发Agent）
5. 测试验证（测试专家Agent）
```

### 2. 依赖关系明确

每个子任务应明确其依赖关系，确保执行顺序正确。

**依赖类型**：

- **串行依赖**：任务B必须在任务A完成后才能开始
- **并行独立**：任务A和任务B可以同时进行
- **条件依赖**：任务B是否执行取决于任务A的结果

### 3. 粒度适中

子任务的粒度应该：

- 足够小：单个Agent可以在一次调用中完成
- 足够大：不要过度拆分导致协调成本过高
- 可验证：每个子任务都有明确的完成标准

## 分解流程

### 步骤1：理解原始任务

```markdown
## 原始任务分析

### 任务目标

{用户想要达成什么目标}

### 任务范围

{包含什么，不包含什么}

### 成功标准

{如何判断任务完成}
```

### 步骤2：识别所需能力

```markdown
## 所需能力清单

1. {能力1}：{描述}
   - 对应Agent：{Agent名称}

2. {能力2}：{描述}
   - 对应Agent：{Agent名称}
```

### 步骤3：拆解子任务

```markdown
## 子任务列表

### 子任务1：{任务名称}

- **负责Agent**：{Agent名称}
- **任务目标**：{具体目标}
- **输入依赖**：{需要哪些输入}
- **输出产物**：{产生什么输出}
- **依赖关系**：{依赖哪些其他子任务}
- **执行顺序**：{第几轮执行}

### 子任务2：{任务名称}

...
```

### 步骤4：构建执行计划

```markdown
## 执行计划

### 第1轮（并行）

- 子任务1（Agent A）
- 子任务2（Agent B）

### 第2轮（串行，依赖第1轮）

- 子任务3（Agent C，依赖子任务1和2的输出）

### 第3轮（条件执行）

- 如果子任务3发现问题 → 子任务4（Agent D）
- 否则 → 子任务5（Agent E）
```

## 分解模式

### 模式1：线性流程分解

适用于：传统产品开发、文档生成等流程明确的任务

```
需求分析 → 设计 → 开发 → 测试 → 部署
```

### 模式2：迭代优化分解

适用于：Agent产品开发、Prompt优化等需要迭代的任务

```
初始设计 → 挑战质疑 → 优化改进 → 再次挑战 → 最终确认
```

### 模式3：并行协作分解

适用于：多模块开发、多维度分析等可并行的任务

```
前端开发 ┐
后端开发 ├→ 集成测试 → 部署
数据库设计┘
```

### 模式4：条件分支分解

适用于：问题诊断、方案选择等需要决策的任务

```
问题分析 →
  ├─ 如果是性能问题 → 性能优化方案
  ├─ 如果是功能缺陷 → 功能修复方案
  └─ 如果是设计问题 → 重新设计方案
```

## 分解示例

### 示例1：开发ReAct Agent产品

```markdown
## 原始任务

开发一个ReAct Agent，用于帮助用户进行市场分析。

## 任务分解

### 第1阶段：需求设计（4个子任务）

#### 子任务1.1：需求澄清

- **负责Agent**：产品需求管理Agent
- **任务目标**：与用户澄清需求，明确Agent的核心功能和使用场景
- **输入依赖**：用户原始需求
- **输出产物**：澄清问题列表 + 用户回答
- **依赖关系**：无
- **执行顺序**：第1轮

#### 子任务1.2：市场调研

- **负责Agent**：产品研究分析Agent
- **任务目标**：调研市场上类似的Agent产品，分析竞品
- **输入依赖**：子任务1.1的输出
- **输出产物**：市场调研报告
- **依赖关系**：依赖子任务1.1
- **执行顺序**：第2轮

#### 子任务1.3：需求设计

- **负责Agent**：产品需求管理Agent
- **任务目标**：设计结构化的需求文档
- **输入依赖**：子任务1.1和1.2的输出
- **输出产物**：需求设计文档
- **依赖关系**：依赖子任务1.1和1.2
- **执行顺序**：第3轮

#### 子任务1.4：需求挑战

- **负责Agent**：需求设计挑战Agent
- **任务目标**：对需求设计进行质量挑战
- **输入依赖**：子任务1.3的输出
- **输出产物**：挑战问题列表
- **依赖关系**：依赖子任务1.3
- **执行顺序**：第4轮

### 第2阶段：战略设计（2个子任务）

#### 子任务2.1：战略设计

- **负责Agent**：战略设计Agent
- **任务目标**：设计Agent的Prompt构造块、工具系统、用户用例
- **输入依赖**：第1阶段的所有输出
- **输出产物**：战略设计文档
- **依赖关系**：依赖第1阶段完成
- **执行顺序**：第5轮

#### 子任务2.2：战略挑战

- **负责Agent**：战略设计挑战Agent
- **任务目标**：对战略设计进行质量挑战
- **输入依赖**：子任务2.1的输出
- **输出产物**：挑战问题列表 + 优化建议
- **依赖关系**：依赖子任务2.1
- **执行顺序**：第6轮

### 第3阶段：开发（6个子任务，部分并行）

#### 子任务3.1：前端开发

- **负责Agent**：前端开发Agent
- **任务目标**：开发Agent的前端界面
- **输入依赖**：第2阶段的所有输出
- **输出产物**：前端代码
- **依赖关系**：依赖第2阶段完成
- **执行顺序**：第7轮（可与3.2并行）

#### 子任务3.2：后端开发

- **负责Agent**：AgentScope React开发Agent
- **任务目标**：开发Agent的后端逻辑和工具集成
- **输入依赖**：第2阶段的所有输出
- **输出产物**：后端代码
- **依赖关系**：依赖第2阶段完成
- **执行顺序**：第7轮（可与3.1并行）

#### 子任务3.3：测试

- **负责Agent**：测试专家Agent
- **任务目标**：测试Agent的功能和性能
- **输入依赖**：子任务3.1和3.2的输出
- **输出产物**：测试报告
- **依赖关系**：依赖子任务3.1和3.2
- **执行顺序**：第8轮

#### 子任务3.4：部署

- **负责Agent**：DevOps Agent
- **任务目标**：部署Agent到生产环境
- **输入依赖**：子任务3.3的输出（测试通过）
- **输出产物**：部署文档
- **依赖关系**：依赖子任务3.3
- **执行顺序**：第9轮

#### 子任务3.5：性能优化

- **负责Agent**：性能优化Agent
- **任务目标**：优化Agent的响应速度和Token消耗
- **输入依赖**：子任务3.4的输出
- **输出产物**：优化报告
- **依赖关系**：依赖子任务3.4
- **执行顺序**：第10轮

#### 子任务3.6：最终验收

- **负责Agent**：开发Agent
- **任务目标**：进行最终验收，确保所有功能正常
- **输入依赖**：所有前序子任务的输出
- **输出产物**：验收报告
- **依赖关系**：依赖所有前序子任务
- **执行顺序**：第11轮
```

## 分解质量检查

### 检查清单

- [ ] 每个子任务都有明确的负责Agent
- [ ] 每个子任务的目标具体可执行
- [ ] 依赖关系清晰，没有循环依赖
- [ ] 输入输出明确，信息传递完整
- [ ] 执行顺序合理，并行任务已识别
- [ ] 粒度适中，不过度拆分也不过于粗糙
- [ ] 每个子任务都有验收标准

### 常见问题

**问题1：任务拆分过细**

- 症状：子任务数量过多（>20个），协调成本高
- 解决：合并相关子任务，提高粒度

**问题2：依赖关系不清**

- 症状：执行时发现缺少必要信息
- 解决：明确每个子任务的输入依赖，确保信息传递完整

**问题3：并行机会未利用**

- 症状：所有任务串行执行，效率低
- 解决：识别独立任务，标记为可并行执行

**问题4：Agent能力不匹配**

- 症状：分配的Agent无法完成任务
- 解决：重新审视Agent能力清单，调整任务分配

## 版本信息

- **版本**：1.0.0
- **最后更新**：2026-01-27
- **变更日志**：
  - 1.0.0：初始版本，定义任务分解方法论
