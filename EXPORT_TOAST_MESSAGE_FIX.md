# 导出PDF提示信息优化

## 修复时间
2026-02-01 15:45

## 问题描述
生成分析报告时，点击【导出PDF】的提示信息不够友好：
- 原提示：`报告正在生成中（45%）`
- 期望提示：`分析报告生成中，稍后重试`

## 修复方案

**文件**: `frontend/js/utils/export-validator.js`

**修改位置**: 第44-61行

### 修改内容

```javascript
// 修改前
if (status === 'generating') {
    const progress = genState[reportType].progress;
    return {
        valid: false,
        error: `报告正在生成中（${progress.percentage}%）`,
        detail: `已完成 ${progress.current}/${progress.total} 个章节`,
        action: 'wait',
        progress: progress
    };
}

// 修改后
if (status === 'generating') {
    const progress = genState[reportType].progress;
    // 根据报告类型返回不同的提示
    const reportTypeName = reportType === 'analysis' ? '分析报告' :
                          reportType === 'business' ? '商业计划书' : '产品立项材料';
    return {
        valid: false,
        error: `${reportTypeName}生成中，稍后重试`,
        detail: `已完成 ${progress.current}/${progress.total} 个章节（${progress.percentage}%）`,
        action: 'wait',
        progress: progress
    };
}
```

## 效果对比

### 分析报告
| 场景 | 修改前 | 修改后 |
|------|--------|--------|
| 主提示 | `报告正在生成中（45%）` | `分析报告生成中，稍后重试` |
| 详细信息 | `已完成 3/6 个章节` | `已完成 3/6 个章节（45%）` |

### 商业计划书
| 场景 | 修改前 | 修改后 |
|------|--------|--------|
| 主提示 | `报告正在生成中（60%）` | `商业计划书生成中，稍后重试` |
| 详细信息 | `已完成 3/5 个章节` | `已完成 3/5 个章节（60%）` |

### 产品立项材料
| 场景 | 修改前 | 修改后 |
|------|--------|--------|
| 主提示 | `报告正在生成中（75%）` | `产品立项材料生成中，稍后重试` |
| 详细信息 | `已完成 3/4 个章节` | `已完成 3/4 个章节（75%）` |

## Toast显示效果

### 修改前
```
⚠️ 报告正在生成中（45%）
   已完成 3/6 个章节
```

### 修改后
```
⚠️ 分析报告生成中，稍后重试
   已完成 3/6 个章节（45%）
```

## 优化说明

### 1. 更明确的报告类型
- 明确指出是"分析报告"、"商业计划书"还是"产品立项材料"
- 用户一眼就能知道是哪个报告在生成

### 2. 更友好的行动建议
- 从"正在生成中"改为"生成中，稍后重试"
- 明确告诉用户应该"稍后重试"，而不是等待

### 3. 更完整的进度信息
- 将百分比移到详细信息中
- 同时显示章节进度和百分比
- 信息更完整，层次更清晰

## 测试验证

### 测试步骤
1. 点击"生成AI分析报告"
2. 在生成过程中点击"导出PDF"
3. 验证Toast提示：
   - ✅ 主提示：`分析报告生成中，稍后重试`
   - ✅ 详细信息：`已完成 X/6 个章节（XX%）`
   - ✅ 类型：warning（黄色）
   - ✅ 时长：5秒

### 测试场景
- [ ] 分析报告生成中导出
- [ ] 商业计划书生成中导出
- [ ] 产品立项材料生成中导出

## 总结

✅ 提示信息更明确（指明报告类型）
✅ 行动建议更友好（稍后重试）
✅ 进度信息更完整（章节+百分比）
✅ 用户体验更好

---

**修复人员**: Claude Sonnet 4.5
**验证状态**: 待测试
**部署状态**: 已部署
